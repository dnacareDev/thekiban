<!doctype html>
<html lang="en" dir="ltr" xmlns:th="http://www.thymeleaf.org">

<head>

    <!-- 공통 헤더 -->
    <th:block th:include="@{/fragments/header.html}"></th:block>

    <style>
        table {
            border-top: 1px solid grey;
            border-collapse: collapse;
        }

        th, td {
            border-bottom: 2px solid #E5E9F2;
            padding: 10px;
            text-align: center;
            font-weight: initial;
        }

        th, tbody tr {
            background-color: white;
        }

    </style>

</head>

<body class="layout-light top-menu overlayScroll">
<div class="mobile-search"></div>

<div class="mobile-author-actions"></div>

<!-- 공통 topbar -->
<th:block th:include="@{/fragments/topbar.html}"></th:block>

<main class="main-content" style="background-color: #FCFCFC;">

    <div class="contents" style="background-color: #FFFFFF;">

        <div class="container-fluid">
            <div class="row">
                <div class="col-lg-12 mb-30">
                    <div class="card">
                        <div class="card-extra mt-20 mr-20">
                            <div class="breadcrumb-main" style="float: left;">
                                <h4 class="text-capitalize breadcrumb-title">품종 관리</h4>
                            </div>
                            <!-- 버튼 등록하는 곳 -->
                            <div class="action-btn d-flex justify-content-end">
                                <div class="atbd-button-list d-flex flex-wrap">
                                    <form action="" name="searchForm" class="d-flex align-items-center add-contact__form my-sm-0 my-2">
                                        <select class="form-control form-control-lg mt-10 mb-10 mr-10" style="width: 250px;">
                                            <option>작물 선택</option>
                                            <option>아이디</option>
                                            <option>이름</option>
                                        </select>
                                    </form>
                                    <input type="file" id="excel_file" onchange="excelExport(event)"/>
                                    <button class="btn btn-lg btn-primary"><span data-feather="download"></span>CSV</button>
                                </div>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="bg-white">
                                <div class="table-responsive" id="displayExcelHtml">
                                    <!--<table class="table">
                                        <thead class="text-center">
                                        <tr>
                                            <th scope="col">#</th>
                                            <th scope="col">name</th>
                                            <th scope="col">email</th>
                                        </tr>
                                        </thead>
                                        <tbody class="text-center">
                                        <tr th:each="data : ${datas}">
                                            <td scope="row" th:text="${data.num}"></td>
                                            <td th:text="${data.name}"></td>
                                            <td th:text="${data.email}"></td>
                                        </tr>
                                        </tbody>
                                    </table>-->
                                </div>

                                <div class="row">
                                    <div class="col-4">
                                        <button class="btn btn-icon btn-light btn-circle" data-toggle="modal" data-target="#grid">
                                            <span data-feather="plus">temp</span>
                                        </button>
                                        <button class="btn btn-icon btn-light btn-circle" data-toggle="modal" data-target="#gen-insert">
                                            <span data-feather="plus"></span>
                                        </button>

                                        <button class="btn btn-icon btn-light btn-circle">
                                            <span data-feather="trash-2"></span>
                                        </button>
                                    </div>
                                    <div class="col-4">
                                        <div class="d-flex justify-content-center mt-30">
                                            <nav class="atbd-page">
                                                <ul class="atbd-pagination d-flex">
                                                    <li class="atbd-pagination__item">
                                                        <a href="#" class="atbd-pagination__link pagination-control"><span
                                                            class="la la-angle-left"></span></a>
                                                        <a href="#" class="atbd-pagination__link"><span class="page-number">1</span></a>
                                                        <a href="#" class="atbd-pagination__link active"><span class="page-number">2</span></a>
                                                        <a href="#" class="atbd-pagination__link"><span class="page-number">3</span></a>
                                                        <a href="#" class="atbd-pagination__link pagination-control"><span
                                                            class="page-number">...</span></a>
                                                        <a href="#" class="atbd-pagination__link"><span class="page-number">12</span></a>
                                                        <a href="#" class="atbd-pagination__link pagination-control"><span
                                                            class="la la-angle-right"></span></a>
                                                        <a href="#" class="atbd-pagination__option">
                                                        </a>
                                                    </li>
                                                </ul>
                                            </nav>
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <!-- modal code -->
    <div class="modal-basic modal fade show" id="gen-attach" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog modal-md" role="document">
            <div class="modal-content modal-bg-white ">
                <div class="modal-header" style="border: none">
                    <h6 class="modal-title">품종관리 > 첨부파일</h6>
                </div>
                <div class="modal-body">
                    <div class="form-group mb-0">
                        <span>제목</span>
                        <input type="text" class="form-control form-control-lg">
                    </div>
                    <div class="form-group mb-0">
                        <textarea style="resize:none;"></textarea>
                    </div>
                    <div>
                        <div class="atbd-upload">
                            <div class="atbd-upload__button">
                                <a href="javascript:void(0)" class="btn btn-lg btn-outline-lighten btn-upload"
                                   onclick="$('#upload').click()"> <span data-feather="upload"></span>Click to Upload</a>
                                <input type="file" name="upload-3" class="upload-one" id="upload">
                            </div>
                            <div class="atbd-upload__file">
                                <ul>
                                    <li>
                                        <a href="#" class="file-name"><i class="las la-paperclip"></i> <span
                                            class="name-text">xxx.png<span></span></span></a>
                                        <a href="#" class="btn-delete"><i class="la la-trash"></i></a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer" style="border: none">
                    <button type="button" class="btn btn-secondary btn-sm" data-dismiss="modal">취소</button>
                    <button type="button" class="btn btn-primary btn-sm">저장</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal-basic modal fade show" id="grid" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog modal-md" role="document">
            <div class="modal-content modal-bg-white ">
                <div class="modal-header" style="border: none">
                    <h6 class="modal-title">품종관리 > 원예형질[종자원 기준]</h6>
                    시교명 ID : <span></span>
                </div>
                <div class="modal-body">
                    <div class="tab-pane fade show active" id="control1" role="tabpanel" aria-labelledby="control1-tab">
                        <div class="tab-slide-content">
                            <div class="atbd-tab tab-horizontal">
                                <ul class="nav nav-tabs vertical-tabs" role="tablist">
                                    <li class="nav-item">
                                        <a class="nav-link active" id="tab-horizontal-1-tab" data-toggle="tab"
                                           href="#tab-horizontal-1" role="tab" aria-controls="tab-horizontal-1"
                                           aria-selected="true">원예형질[종자원 기준]</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" id="tab-horizontal-2-tab" data-toggle="tab"
                                           href="#tab-horizontal-2" role="tab" aria-controls="tab-horizontal-2"
                                           aria-selected="false">원예형질[사내 기준]</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" id="tab-horizontal-3-tab" data-toggle="tab"
                                           href="#tab-horizontal-3" role="tab" aria-controls="tab-horizontal-3"
                                           aria-selected="false">병저항성[종자원 기준]</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" id="tab-horizontal-4-tab" data-toggle="tab"
                                           href="#tab-horizontal-4" role="tab" aria-controls="tab-horizontal-4"
                                           aria-selected="false">병저항성[사내 기준]</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" id="tab-horizontal-5-tab" data-toggle="tab"
                                           href="#tab-horizontal-5" role="tab" aria-controls="tab-horizontal-5"
                                           aria-selected="false">성분정보[종자원 기준]</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" id="tab-horizontal-6-tab" data-toggle="tab"
                                           href="#tab-horizontal-6" role="tab" aria-controls="tab-horizontal-6"
                                           aria-selected="false">마커정보</a>
                                    </li>
                                </ul>
                                <div class="tab-content">
                                    <div class="tab-pane fade show active" id="tab-horizontal-1" role="tabpanel"
                                         aria-labelledby="tab-horizontal-1-tab">
                                        <p>Content of Tab Pane 1</p>
                                    </div>
                                    <div class="tab-pane fade" id="tab-horizontal-2" role="tabpanel"
                                         aria-labelledby="tab-horizontal-2-tab">
                                        <p>Content of Tab Pane 2</p>
                                    </div>
                                    <div class="tab-pane fade" id="tab-horizontal-3" role="tabpanel"
                                         aria-labelledby="tab-horizontal-3-tab">
                                        <p>Content of Tab Pane 3</p>
                                    </div>
                                    <div class="tab-pane fade" id="tab-horizontal-4" role="tabpanel"
                                         aria-labelledby="tab-horizontal-4-tab">
                                        <p>Content of Tab Pane 4</p>
                                    </div>
                                    <div class="tab-pane fade" id="tab-horizontal-5" role="tabpanel"
                                         aria-labelledby="tab-horizontal-5-tab">
                                        <p>Content of Tab Pane 5</p>
                                    </div>
                                    <div class="tab-pane fade" id="tab-horizontal-6" role="tabpanel"
                                         aria-labelledby="tab-horizontal-6-tab">
                                        <p>Content of Tab Pane 6</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer" style="border: none">
                    <button type="button" class="btn btn-secondary btn-sm" data-dismiss="modal">취소</button>
                    <button type="button" class="btn btn-primary btn-sm">저장</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal-basic modal fade show" id="gen-insert" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog modal-md" role="document">
            <div class="modal-content modal-bg-white ">
                <div class="modal-header" style="border: none">
                    <h6 class="modal-title">INSERT ROW</h6>
                </div>
                <div class="modal-body">
                    <div class="form-group mb-0">
                        <span>Title</span>
                        <input type="text" class="form-control form-control-lg">
                    </div>
                    <div class="form-group mb-0">
                        <span>품종명</span>
                        <input type="text" class="form-control form-control-lg">
                    </div>
                    <div class="form-group mb-0">
                        <span>특성상태</span>
                        <input type="text" class="form-control form-control-lg">
                    </div>
                    <div class="form-group mb-0">
                        <span>모계 계통명</span>
                        <input type="text" class="form-control form-control-lg">
                    </div>
                    <div class="form-group mb-0">
                        <span>부계 계통명</span>
                        <input type="text" class="form-control form-control-lg">
                    </div>
                    <div class="form-group mb-0">
                        <span>생산판매(신고번호)</span>
                        <input type="text" class="form-control form-control-lg">
                    </div>
                    <div class="form-group mb-0">
                        <span>생산판매(신고일자)</span>
                        <input type="text" class="form-control form-control-lg">
                    </div>
                </div>
                <div class="modal-footer" style="border: none">
                    <button type="button" class="btn btn-secondary btn-sm" data-dismiss="modal">취소</button>
                    <button type="button" class="btn btn-primary btn-sm">저장</button>
                </div>
            </div>
        </div>
    </div>
    <!-- modal end -->
</main>

<!-- 공통 하단 -->
<th:block th:include="@{/fragments/footer.html}"></th:block>
<!-- 공통 js -->
<th:block th:include="@{/fragments/commonjs.html}"></th:block>

<script type="text/javascript">
    function excelExport(event) {
        excelExportCommon(event, handleExcelDataAll);
    }

    function excelExportCommon(event, callback) {
        var input = event.target;
        var reader = new FileReader();
        reader.onload = function () {
            var fileData = reader.result;
            var wb = XLSX.read(fileData, {type: 'binary'});
            var sheetNameList = wb.SheetNames; // 시트 이름 목록 가져오기
            var firstSheetName = sheetNameList[0]; // 첫번째 시트명
            var firstSheet = wb.Sheets[firstSheetName]; // 첫번째 시트
            callback(firstSheet);
        };
        reader.readAsBinaryString(input.files[0]);
    }

    function handleExcelDataAll(sheet) {
        handleExcelDataHeader(sheet); // header 정보
        handleExcelDataJson(sheet); // json 형태
        handleExcelDataCsv(sheet); // csv 형태
        handleExcelDataHtml(sheet); // html 형태
    }

    function handleExcelDataHeader(sheet) {
        var headers = get_header_row(sheet);
        $("#displayHeaders").html(JSON.stringify(headers));
    }

    function handleExcelDataJson(sheet) {
        $("#displayExcelJson").html(JSON.stringify(XLSX.utils.sheet_to_json(sheet)));
    }

    function handleExcelDataCsv(sheet) {
        $("#displayExcelCsv").html(XLSX.utils.sheet_to_csv(sheet));
    }

    function handleExcelDataHtml(sheet) {
        $("#displayExcelHtml").html(XLSX.utils.sheet_to_html(sheet));
    }

    function get_header_row(sheet) {
        var headers = [];
        var range = XLSX.utils.decode_range(sheet['!ref']);
        var C, R = range.s.r;

        for (C = range.s.c; C <= range.e.c; ++C) {
            var cell = sheet[XLSX.utils.encode_cell({c: C, r: R})]

            var hdr = "UNKNOWN " + C;
            if (cell && cell.t) hdr = XLSX.utils.format_cell(cell);

            headers.push(hdr);
        }
        return headers;
    }
</script>

</body>

</html>