<!doctype html>
<html lang="en" dir="ltr" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security" th:with="user = ${#authentication.principal}">
<head>
    <!-- 공통 헤더 -->
    <th:block th:include="/../fragments/header.html"></th:block>
    <script src="../assets/vendor_assets/js/script.js"></script>
    <style>
        .card {
            box-shadow: 0 3px 20px 3px rgb(0 0 0 / 7%);
        }

        table {
            border-top: 1px solid grey;
            border-collapse: collapse;
        }

        th, td {
            border-bottom: 2px solid #E5E9F2;
            padding: 10px;
            text-align: center;
            font-weight: initial;
        }

        th, tbody tr {
            background-color: white;
        }

        .main-content .card-extra .justify-content-end .atbd-button-list {
            width: 100%;
            margin: 0;
        }

        .main-content .nav-tabs .nav-link.active, .main-content .nav-tabs .nav-item.show .nav-link, .modal-basic .atbd-tab .nav-link {
            color: #D9D9D9;
            font-size: 16px;
            font-weight: 700;
        }

        .main-content .atbd-tab .nav-link:after {
            background-color: #f4f5f7;
        }

        .modal-basic .atbd-tab .nav-tabs .nav-item.active a {
            border-radius: 21px;
            background-color: #EDF6F1;
            color: #217566;
            font-size: 16px;
            font-weight: 700;
        }

        .modal-basic .atbd-tab .nav-tabs .nav-item a::after,
        .modal-basic .atbd-tab .nav-tabs:after {
            display: none;
        }

        .content_title {
            width: 100%;
            background-color: #F7F7F8;
            padding: 10px 0;
        }

        /*.content_title li { alpaDesign 수정
            float: left;
            width: 50%;
            text-align: center;
        }*/

        .content_1 {
            padding: 20px;
            max-height: 500px;
            overflow: auto;
            line-height: 2;
        }

        .content_1 .title {
            float: left;
        }

        .content_1 .input_text {
            float: right;
            width: 50%;
        }

        .content_1 .input_text input[type="text"] {
            width: 100%;
        }

        .content_1 li {
            display: inline-block;
            width: 100%;
            color: #222222;
            font-size: 16px;
        }

        .pop1 .modal-dialog textarea {
            width: 100%;
            height: 150px;
            border-radius: 5px;
            border: 1px solid #D9D9D9;
            margin-top: 20px;
        }

        .pop1 .modal-dialog .btn-upload {
            width: 100%;
        }

        .pop1 .atbd-upload__file {
            display: none;
        }

        .pop2 .modal-header {
            display: -webkit-box;
        }

        .main-content .pop1 .form-group input[type=text] {
            flex: 0 0 85%;
        }

        .main-content .pop1 .form-group span {
            flex: 0 0 10%;
        }

        .main-content .pop1 a.btn-outline-lighten {
            display: block;
            text-align: left;
            color: #B2B2B2;
        }

        #gen-messege {
            display: table;
        }

        #gen-messege .modal-dialog {
            display: table-cell;
            vertical-align: middle;
        }

        #gen-messege .modal-dialog .modal-content {
            max-width: 700px;
            margin: 0 auto;
            text-align: center;
            padding: 40px 0;
        }

        #gen-messege .modal-dialog .modal-content .messege {
            padding-bottom: 30px;
        }

        .main-content .modal-body {
            width: 100%;
        }

        .main-content .modal-body .content_title ul li {
            display: inline-block;
            width: calc((100% - 50px) / 2);
            margin-left: 40px;
            overflow: hidden;
            text-align: center;
        }

        .main-content .modal-body ul li:first-child {
            margin-left: 0;
        }

        .main-content .modal-body ul li img {
            width: 100%;
        }

        #google_container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 15px;
            height: 500px;
        }

        #google_container li {
            flex: 1;
            height: 100%;
        }

        @media (min-width: 576px) {
            .modal-dialog {
                max-width: 1014px;
                margin: 1.75rem auto;
            }

            #recent .modal-dialog {
                max-width: 1300px;
                margin: 1.75rem auto;
            }

            /* 2021 - 11 - 02 수정 */
            .pop1 .modal-dialog {
                max-width: 750px;
            }

            .pop4 .modal-dialog {
                max-width: 750px;
                margin: 0 auto;
            }
        }

        .btn.btn-light.btn-transparent-light {
            display: block;
            width: 100%;
            background-color: transparent;
        }

        .main-content .contents .container-fluid {
            max-width: 100%;
            padding: 50px;
        }

        .bg-white > .row {
            padding-top: 0px;
        }

        .table th, .table td {
            vertical-align: middle;
        }

        td .btn i.bi-file-earmark-arrow-down {
            color: #000;
        }

        .table td {
            padding: 0px 12px;
            vertical-align: middle;
            font-size: 14px;
            border-bottom: 2px solid #d9d9d9;
        }

        .table th {
            font-size: 16px;
            border-top: 1px solid #d9d9d9;
        }

        .table thead th {
            border-bottom: 2px solid #adadad;
        }

        #table2 td {
            padding: 12px 12px;
            font-size: 14px
        }

        #table2 th {
            font-size: 16px
        }

        .main-content .table thead th span.title:before,
        .main-content .table thead th span.title:after,
        .main-content .table thead th i {
            display: none;
        }

        .main-content .table thead th > img {
            margin: 6px 0 0 12px;
        }

        #data_upload .form-group input[type=text]::placeholder {
            text-align: left;
            text-indent: 20px
        }

        .popup_wrap {
            display: none
        }

        .popup_wrap.on {
            display: block;
            position: fixed;
            left: 0;
            top: 0;
            right: 0;
            bottom: 0;
            z-index: 999;
            background-color: rgba(0, 0, 0, 0.1);
        }

        .popup_wrap.on .popup {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 400px;
            height: 150px;
            background-color: #fff;
            border-radius: 8px;
            padding: 30px;
            text-align: center;
            padding-top: 40px
        }

        .popup_wrap.on .close {
            opacity: 1;
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            bottom: 20px;
            font-size: 14px;
            background-color: #1e695c;
            display: block;
            height: 35px;
            width: 90px;
            color: #fff;
            font-weight: 400;
            border-radius: 6px
        }


        #data_upload1 .modal-body .form-group, #data_upload .modal-body .form-group {
            justify-content: flex-start;
        }

        #data_upload .form-group button, #data_upload2 .form-group button, #data_upload3 .form-group button, #sample_file .form-group button {
            height: 45px;
            padding: 0 20px;
            background-color: #217566;
            color: #fff;
            border: none;
            border-radius: 5px;
            margin-left: 10px;
        }

        #data_upload2 .form-group button, #data_upload3 .form-group button, #sample_file .form-group button {
            margin-left: 0;
        }

        #data_upload .form-group input[type=text], #data_upload2 .form-group input[type=text], #data_upload3 .form-group input[type=text], #sample_file .form-group input[type=text] {
            flex: 0 0 30%;
            cursor: pointer;
        }

        #data_upload .form-group input[type=text]::-webkit-input-placeholder {
            background: url("../assets/vendor_assets/img/upload.png") no-repeat 0 3px;
            background-size: 15px;
            color: #B2B2B2;
        }

        #data_upload .atbd-upload, #data_upload2 .atbd-upload, #data_upload3 .atbd-upload, #sample_file .atbd-upload {
            width: 100%;
            height: 300px;
            overflow: auto;
        }

        #data_upload .atbd-upload table {
            min-width: max-content;
            border: none;
        }

        #data_upload2 .atbd-upload table, #data_upload3 .atbd-upload table, #sample_file .atbd-upload table {
            width: 100%;
        }

        #data_upload table thead tr, #data_upload2 table thead tr, #data_upload3 table thead tr, #sample_file table thead tr {
            border-top: none;
            border-bottom: 2px solid #E8EEF2;
        }

        #data_upload table tbody tr, #data_upload2 table tbody tr, #data_upload3 table tbody tr, #sample_file table tbody tr {
            border-bottom: 1px solid #E8EEF2;
        }

        #data_upload .atbd-upload table thead th, #data_upload2 .atbd-upload table thead th, #data_upload3 .atbd-upload table thead th, #sample_file .atbd-upload table thead th {
            background-color: #F7F7F8;
            color: #222222;
            font-size: 16px;
        }

        #data_upload .atbd-upload table tbody td, #data_upload2 .atbd-upload table tbody td, #data_upload3 .atbd-upload table tbody td, #sample_file .atbd-upload table tbody td {
            background-color: #fff;
            color: #666666;
            font-size: 16px;
            font-weight: 200;
        }

        /* 2021 - 11 - 02 수정 */
        #data_upload .form-group button {
            line-height: 2rem;
            font-size: 13px;
            height: 34px;
            margin-left: 5px;
        }

        #data_upload .form-group input[type=text] {
            height: 34px;
        }

        #data_upload .form-group input[type=text]::placeholder {
            text-align: left;
            text-indent: 20px;
            font-size: 14px;
        }

        .contents .container-fluid {
            background-color: #FCFCFC;
        }

        #excel_data {
            width: 100%;
        }

        .modal-content .modal-footer {
            padding-bottom: 28px;
            padding-right: 24px;
        }

        .modal-search {
            width: 250px;
        }

        .btn-primary {
            border: none;
        }

        .main-content .card-extra .justify-content-end .atbd-button-list .data_btn1,
        .main-content .card-extra .justify-content-end .atbd-button-list .data_btn2,
        .main-content .card-extra .justify-content-end .atbd-button-list .form-control {
            height: 36px;
        }

        .main-content .card-extra .justify-content-end .atbd-button-list .data_btn1,
        .main-content .card-extra .justify-content-end .atbd-button-list .data_btn2 {
            width: 31px;
            margin-top: 12px;
            padding: 0px 19px;
        }


        .atbd-button-list button {
            margin: 5px 3px;
        }

        #data_upload2 .form-group button, #data_upload3 .form-group button, #sample_file .form-group button {
            height: 34px;
            line-height: 2rem;
            font-size: 13px;
        }

        #excel_data {
            width: 100%;
        }

        .col-4 .bottom_btn > span {
            height: 34px;
            line-height: 2rem;
            font-size: 13px;
        }

        /* 푸터 배경색 */
        .footer-wrapper {
            background-color: #FCFCFC;
        }

        .contextmenu li {
            border-left: 3px solid transparent;
            transition: ease .2s;
        }

        .contextmenu li a {
            display: block;
            padding: 10px;
            color: #B0BEC5;
            background: #FFFFFF;
            text-decoration: none;
            transition: ease .2s;
        }

        .contextmenu li:hover {
            border-left: 3px solid #9C27B0;
        }

        .contextmenu li:hover a {
            color: #FFFFFF;
        }

        /* input 크기 */
        .rowInput {
            width: 115px;
        }

        .box_center .buttonLi button {
            width: 32px;
            height: 32px;
            border: 2px solid #217566;
            background-color: transparent;
            border-radius: 50%;
        }

        .box_center .buttonLi button svg {
            display: none;
        }

        .box_center .buttonLi button span {
            position: relative;
        }

        .box_center .buttonLi button span::before {
            content: "";
            display: block;
            position: absolute;
            top: -1px;
            left: 0;
            width: 2px;
            height: 10px;
            background-color: #217566;
            transform: rotate(45deg);
        }

        .box_center .buttonLi button span::after {
            content: "";
            display: block;
            position: absolute;
            top: -7px;
            left: 0;
            width: 2px;
            height: 10px;
            background-color: #217566;
            transform: rotate(-45deg);
        }

        .box_center .buttonLi button span.left_btn::before {
            left: -2px;
            transform: rotate(-45deg);
        }

        .box_center .buttonLi button span.left_btn::after {
            left: -2px;
            transform: rotate(45deg);
        }

        #grid2 .tab-content .row .detail_list li {
            width: 100%;
            border-bottom: 1px solid #E2E3E5;
        }

        #grid2 .tab-content .row .list-group {
            width: 100%;
            margin: 0 !important;
        }

        #grid2 .tab-content .row .detail_list li:hover,
        #grid2 .tab-content .row .display_list li:hover {
            background-color: #EDF6F1;
        }

        #grid2 .tab-content .row .detail_list li.active,
        #grid2 .tab-content .row .display_list li.active {
            background-color: #217566;
            color: #fff;
            border: none;
        }

        #grid2 .tab-content .row .display_list li .row {
            margin-left: 0;
            margin-right: 0;
            display: block;
        }

        #grid2 input[type="checkbox"] {
            display: none !important;
        }

        #grid2 .tab-content .row li {
            padding: 0 10px !important;
        }

        input[type="text"].updateInput {
            border: none;
            height: 45px;
            text-align: center;
        }

        #sampleGrid .tui-grid-body-area td[data-column-name='sample_code'], #sampleGrid .tui-grid-body-area td[data-column-name='sample_seed'] {
            color: mediumblue;
            text-decoration: underline;
            cursor: pointer;
        }

        #sampleGrid .tui-grid-body-area td[data-column-name='file'] {
            cursor: pointer;
        }

        #outcomeGrid .tui-grid-body-area td[data-column-name='sample_outcome_num'] {
            color: mediumblue;
            text-decoration: underline;
            cursor: pointer;
        }

        #saveRow, #updateRow {
            float: right;
            color: #fff;
            background-color: #217566;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
        }

        #cancelRow, #cancelUpdate {
            float: right;
            color: #217566;
            background-color: #fff;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
        }

        #saveRow1, #updateRow1 {
            float: right;
            color: #fff;
            background-color: #217566;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
        }

        #cancelRow1, #cancelUpdate1 {
            float: right;
            color: #217566;
            background-color: #fff;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
        }

        #saveRow2, #updateRow2 {
            float: right;
            color: #fff;
            background-color: #217566;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
        }

        #cancelRow2, #cancelUpdate2 {
            float: right;
            color: #217566;
            background-color: #fff;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
        }

        #pop_breed table thead tr, #pop_seed table thead tr {
            border-top: 2px solid #aaa;
            border-bottom: 2px solid #aaa;
            border-bottom: 2px solid #E5E9F2;
        }

        #pop_breed table thead th, #pop_seed table thead th {
            border-left: 1px solid #eee;
            border-right: 1px solid #eee;
            border-bottom: 2px solid #E5E9F2;
            color: #222;
            font-size: 13px;
        }

        #pop_breed table thead th:first-child, #pop_seed table thead th:first-child {
            border-left: none;
        }

        #pop_breed table thead th:last-child, #pop_seed table thead th:last-child {
            border-right: none;
        }

        #pop_breed table tbody tr, #pop_seed table tbody tr {
            border-bottom: 1px solid #eee;
        }

        #pop_breed table tbody td, #pop_seed table tbody td {
            background-color: #fff;
            color: #333;
            font-size: 13px;
        }

        #pop_seed table tbody td {
            padding: 12px 12px;
        }

        .plus_btn_submit1 {
            display: none;
        }

        .plus_btn_submit2 {
            display: none;
        }

        .plus_btn_submit3 {
            display: none;
        }

        .plus_btn_submit4 {
            display: none;
        }

        .plus_btn_submit5 {
            display: none;
        }

        .plus_btn_submit6 {
            display: none;
        }

        .bg-white .row {
            padding-top: 0;
        }

        #data_upload12 .form-group button, #data_upload2 .form-group button, #basic_file .form-group button, #data_upload1 .form-group button, #data_upload21 .form-group button {
            height: 45px;
            padding: 0 20px;
            background-color: #217566;
            color: #fff;
            border: none;
            border-radius: 5px;
            margin-left: 10px;
        }

        #data_upload2 .form-group button, #basic_file .form-group button, #data_upload21 .form-group button {
            margin-left: 0;
        }

        #data_upload12 .form-group input[type=text], #data_upload2 .form-group input[type=text], #basic_file .form-group input[type=text], #data_upload21 .form-group input[type=text], #data_upload1 .form-group input[type=text] {
            flex: 0 0 30%;
            cursor: pointer;
        }

        #data_upload12 .form-group input[type=text]::-webkit-input-placeholder, #data_upload1 .form-group input[type=text]::-webkit-input-placeholder {
            background: url("../assets/vendor_assets/img/upload.png") no-repeat 0 3px;
            background-size: 15px;
            color: #B2B2B2;
        }

        #data_upload12 .atbd-upload, #data_upload2 .atbd-upload, #data_upload21 .atbd-upload, #data_upload1 .atbd-upload {
            width: 100%;
            height: 300px;
            overflow: auto;
        }

        #data_upload12 .atbd-upload table, #data_upload1 .atbd-upload table {
            width: max-content;
            border: none;
            min-width: 100%;
        }

        #data_upload2 .atbd-upload table, #data_upload21 .atbd-upload table {
            width: 100%;
        }

        #data_upload12 table thead tr, #data_upload2 table thead tr, #data_upload21 table thead tr, #data_upload1 table thead tr {
            border-top: none;
            border-bottom: 2px solid #E8EEF2;
        }

        #data_upload12 table tbody tr, #data_upload2 table tbody tr, #data_upload21 table tbody tr, #data_upload1 table tbody tr {
            border-bottom: 1px solid #E8EEF2;
        }

        #data_upload12 .atbd-upload table thead th, #data_upload2 .atbd-upload table thead th, #data_upload21 .atbd-upload table thead th, #data_upload1 .atbd-upload table thead th {
            background-color: #F7F7F8;
            color: #222222;
            font-size: 16px;
        }

        #data_upload12 .atbd-upload table tbody td, #data_upload2 .atbd-upload table tbody td, #data_upload21 .atbd-upload table tbody td, #data_upload1 .atbd-upload table tbody td {
            background-color: #fff;
            color: #666666;
            font-size: 16px;
            font-weight: 200;
        }

        /* 2021 - 11 - 01 수정 */
        #basic_list td {
            padding: 0px 12px;
            vertical-align: middle;
            font-size: 14px
        }

        #basic_list th {
            font-size: 16px
        }

        .main-content .contents .container-fluid {
            max-width: 100%;
            padding: 50px;
        }

        .btn.btn-light.btn-transparent-light {
            display: block;
            width: 100%;
            background-color: rgba(244, 245, 247, 0);
        }

        .main-content .contents .container-fluid {
            max-width: 100%;
            padding: 50px;
        }

        .table th, .table td {
            vertical-align: middle;
        }

        td .btn i.bi-file-earmark-arrow-down {
            color: #000;
        }

        .table td {
            padding: 0px 12px;
            vertical-align: middle;
            font-size: 14px;
            border-bottom: 2px solid #d9d9d9;
        }

        /* 2021 - 11 - 02 수정 */
        .table th {
            font-size: 16px;
            border-top: 1px solid #d9d9d9;
        }

        /* 2021 - 11 - 02 수정 */
        .table thead th {
            border-bottom: 2px solid #adadad;
        }

        /* 2021 - 11 - 02 수정 */

        #table2 td {
            padding: 12px 12px;
            font-size: 14px
        }

        #table2 th {
            font-size: 16px
        }

        .main-content .table thead th span.title:before,
        .main-content .table thead th span.title:after,
        .main-content .table thead th i {
            display: none;
        }

        .main-content .table thead th > img {
            margin: 6px 0 0 12px;
        }

        .popup_wrap {
            display: none
        }

        .popup_wrap.on {
            display: block;
            position: fixed;
            left: 0;
            top: 0;
            right: 0;
            bottom: 0;
            z-index: 999;
            background-color: rgba(0, 0, 0, 0.1);
        }

        .popup_wrap.on .popup {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 400px;
            height: 150px;
            background-color: #fff;
            border-radius: 8px;
            padding: 30px;
            text-align: center;
            padding-top: 40px
        }

        .popup_wrap.on .close {
            opacity: 1;
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            bottom: 20px;
            font-size: 14px;
            background-color: #1e695c;
            display: block;
            height: 35px;
            width: 90px;
            color: #fff;
            font-weight: 400;
            border-radius: 6px
        }

        /* 2021 - 11 - 02 수정 */
        #data_upload2 .form-group button, #data_upload12 .form-group button, #data_upload1 .form-group button {
            line-height: 2rem;
            font-size: 13px;
            height: 34px;
            margin-left: 5px;
        }

        #data_upload2 .form-group input[type=text], #data_upload1 .form-group input[type=text] {
            height: 34px;
        }

        #data_upload2 .form-group input[type=text]::placeholder, #data_upload1 .form-group input[type=text]::placeholder {
            text-align: left;
            text-indent: 20px;
            font-size: 14px;
        }

        .tui-grid-cell {
            background-color: white;
        }

        #pop_breed table thead tr {
            border-top: 2px solid #aaa;
            border-bottom: 2px solid #aaa;
        }

        #pop_breed table thead th {
            border-left: 1px solid #eee;
            border-right: 1px solid #eee;
            border-bottom: 2px solid #E5E9F2;
            color: #222;
            font-size: 13px;
            padding: 10px;
        }

        #pop_breed table thead th:first-child {
            border-left: none;
        }

        #pop_breed table thead th:last-child {
            border-right: none;
        }

        #pop_breed table tbody tr {
            border-bottom: 1px solid #eee;
        }

        #pop_breed table tbody td {
            background-color: #fff;
            border-bottom: 2px solid #E5E9F2;
            color: #333;
            font-size: 13px;
            padding: 10px;
        }


        .load_wrap {
            display: none;
        }

        .load_wrap.on {
            display: flex;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 9999999999;
            background-color: rgba(0, 0, 0, 0.3);
            justify-content: center;
            align-items: center;
        }

        .load_wrap .load {
            background-color: #fff;
            width: 220px;
            height: 90px;
            text-align: center;
            padding: 15px;
            border-radius: 6px;
        }

        .load_wrap .load > h2 {
            font-size: 17px;
            font-weight: bold;
            color: #666;
        }

        .loader,
        .loader:before,
        .loader:after {
            border-radius: 50%;
            width: 1.3em;
            height: 1.3em;
            -webkit-animation-fill-mode: both;
            animation-fill-mode: both;
            -webkit-animation: load7 1.8s infinite ease-in-out;
            animation: load7 1.8s infinite ease-in-out;
        }

        .loader {
            color: #397FF4;
            font-size: 10px;
            margin: -10px auto 0;
            position: relative;
            text-indent: -9999em;
            -webkit-transform: translateZ(0);
            -ms-transform: translateZ(0);
            transform: translateZ(0);
            -webkit-animation-delay: -0.16s;
            animation-delay: -0.16s;
        }

        .loader:before,
        .loader:after {
            content: '';
            position: absolute;
            top: 0;
        }

        .loader:before {
            left: -2.2em;
            -webkit-animation-delay: -0.32s;
            animation-delay: -0.32s;
        }

        .loader:after {
            left: 2.2em;
        }

        @-webkit-keyframes load7 {
            0%,
            80%,
            100% {
                box-shadow: 0 2.5em 0 -1.3em;
            }
            40% {
                box-shadow: 0 2.5em 0 0;
            }
        }

        @keyframes load7 {
            0%,
            80%,
            100% {
                box-shadow: 0 2.5em 0 -1.3em;
            }
            40% {
                box-shadow: 0 2.5em 0 0;
            }
        }

        /* 여기서부터 */
        .main-content .form-group:nth-child(2) {
            display: block;
            width: 100%;
        }

        .image-container {
            width: 300px;
            height: 200px;
            margin: 0 auto;
        }

        .image-container img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }
    </style>
</head>

<body class="layout-light top-menu overlayScroll" oncontextmenu='return false'>
<div class="mobile-search"></div>
<div class="mobile-author-actions"></div>
<!-- 공통 topbar -->
<th:block th:include="/../fragments/topbar.html"></th:block>
<main class="main-content" style="background-color: #FCFCFC;">
    <div class="contents" style="background-color: #FFFFFF;">
        <div class="container-fluid">
            <div class="row">
                <div class="col-lg-12 mb-30">
                    <div class="card" id="cardPlus">
                        <div class="card-extra mt-20 mr-20">
                            <div class="breadcrumb-main" style="float: left;">
                                <h4 class="text-capitalize breadcrumb-title">시교자원 관리</h4>
                                <input type="hidden" id="user_type" th:value="${user.user_type}">
                            </div>
                            <div class="action-btn d-flex justify-content-end">
                                <div class="atbd-button-list d-flex flex-wrap">
                                    <div class="btn-group atbd-button-group btn-group-normal my-2" role="group">
                                        <button type="button" class="btn btn-xs btn-outline-light" id="sampleTable1">시교관리</button>
                                        <button type="button" class="btn btn-xs btn-outline-light" id="sampleTable2">시교출고관리</button>
                                    </div>

                                    <form action="" name="searchForm" class="d-flex align-items-center add-contact__form my-sm-0 my-2">
                                        <select class="form-control form-control-lg mt-10 mb-10 mr-10" style="width: 250px; float: left;" id="limit">
                                            <option value="10">10개</option>
                                            <option value="20">20개</option>
                                            <option value="30">30개</option>
                                        </select>
                                        <select class="form-control form-control-lg mt-10 mb-10 mr-10" style="width: 250px;" id="CropSelect">
                                            <option value="고추">고추</option>
                                            <option value="대파">대파</option>
                                            <option value="멜론">멜론</option>
                                            <option value="무">무</option>
                                            <option value="배추">배추</option>
                                            <option value="수박">수박</option>
                                            <option value="양배추">양배추</option>
                                            <option value="양파">양파</option>
                                            <option value="참외">참외</option>
                                            <option value="토마토">토마토</option>
                                        </select>
                                    </form>
                                    <button class="btn btn-lg btn-primary data_btn2" title="데이터 등록" onclick="openExcel()">
                                        <img src="../assets/vendor_assets/img/icon1.png" alt="">
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class='card-extra mt-10 mb-10 mr-20 plus_btn_submit1'>
                            <button type='button' id="cancelRow" onclick="cancelRow()">취소</button>
                            <button type='button' id="saveRow" onclick="saveRow()">저장</button>
                        </div>
                        <div class='card-extra mt-10 mb-10 mr-20 plus_btn_submit2'>
                            <button type='button' id="cancelUpdate" onclick="cancelUpdate()">취소</button>
                            <button type='button' id="updateRow" onclick="updateRow()">수정</button>
                        </div>
                        <div class="card-body" style="padding-top: 0;">
                            <div class="bg-white">
                                <div id="grid"></div>
                                <div id="sampleGrid"></div>
                                <div id="outcomeGrid"></div>
                                <div class="row">
                                    <div class="col-4">
                                        <button class="btn btn-icon btn-light btn-circle" onclick="insertRow()">
                                            <span data-feather="plus"></span>
                                        </button>
                                        <button class="btn btn-icon btn-light btn-circle" onclick="DeleteSample()">
                                            <span data-feather="trash-2"></span>
                                        </button>
                                    </div>
                                    <div class="col-4">
                                        <div class="row" style="justify-content: center;">
                                            <div id="pageNum" style="text-align:center; margin: 2% 0 0 0;"></div>
                                        </div>
                                    </div>
                                    <div class="col-4">
                                        <button class="btn btn-lg btn-primary bottom_btn" data-toggle="modal" data-target="#recent">
                                            <span>시교 진행 현황</span>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <!-- modal code -->
    <!-- 첨부파일 리스트  2021-11-04 -->
    <div class="modal-basic modal fade show pop7" id="sample_file" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog modal-md" role="document">
            <div class="modal-content modal-bg-white ">
                <div class="modal-header" style="border: none">
                    <h6 class="modal-title">시교자원관리 > 첨부파일</h6>
                </div>
                <div class="modal-body">
                    <div class="form-group mb-0">
                        <button onclick="InsertFileBtn()">데이터 등록</button>
                    </div>
                    <div>
                        <div class="atbd-upload">
                            <table>
                                <thead>
                                <tr>
                                    <th>순번</th>
                                    <th>제목</th>
                                    <th>등록일</th>
                                </tr>
                                </thead>
                                <tbody id="file_list">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="modal-footer" style="border: none">
                    <button type="button" class="btn btn-secondary btn-sm" data-dismiss="modal">취소</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 첨부파일 등록 -->
    <div class="modal-basic modal fade show pop1" id="insert_file" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog modal-md" role="document">
            <div class="modal-content modal-bg-white ">
                <div class="modal-header" style="border: none">
                    <h6 class="modal-title">시교자원관리 > 첨부파일</h6>
                </div>
                <form action="insertSampleFile" id="insertFile" method="POST" enctype="multipart/form-data">
                    <div class="modal-body">
                        <div class="form-group mb-0">
                            <span>제목</span>
                            <input type="text" class="form-control form-control-lg inputText file_title" name="sample_file_title">
                        </div>
                        <div class="form-group mb-0">
                            <textarea name="sample_file_contents" style="resize:none;"></textarea>
                        </div>
                        <div>
                            <div class="atbd-upload">
                                <div class="atbd-upload__button">
                                    <input type="file" id="upload_file" name="file">
                                </div>
                                <div class="atbd-upload__file">
                                    <ul>
                                        <li>
                                            <a href="#" class="file-name"><i class="las la-paperclip"></i> <span
                                                class="name-text">xxx.png<span></span></span></a>
                                            <a href="#" class="btn-delete"><i class="la la-trash"></i></a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer" style="border: none">
                        <input type="hidden" id="upload_id" name="sample_id">
                        <button type="button" class="btn btn-secondary btn-sm" onclick="dataToggle('#insert_file', '#sample_file');">취소</button>
                        <button type="button" class="btn btn-primary btn-sm" onclick="InsertFile();">저장</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- 등록된 첨부파일 -->
    <div class="modal-basic modal fade show pop1" id="modify_file" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog modal-md" role="document">
            <div class="modal-content modal-bg-white ">
                <div class="modal-header" style="border: none">
                    <h6 class="modal-title">시교자원관리 > 첨부파일</h6>
                    <span class="sample_title"></span>
                </div>
                <form action="updateSampleFile" id="modifyFile" method="POST" enctype="multipart/form-data">
                    <div class="modal-body">
                        <div class="form-group mb-0">
                            <span>제목</span>
                            <input type="text" class="form-control form-control-lg inputText" id="sample_file_title" name="sample_file_title">
                        </div>
                        <div class="form-group mb-0">
                            <div class="image-container">
                                <img id="preview-image">
                            </div>
                            <textarea id="sample_file_contents" name="sample_file_contents" style="resize:none;"></textarea>
                        </div>
                        <div>
                            <div class="atbd-upload">
                                <div class="atbd-upload__button">
                                    <a href="" class="btn btn-lg btn-outline-lighten btn-upload" id="file_download" download>
                                        <span data-feather="upload"></span>
                                        <span id="uploads_origin_file"></span>
                                    </a>
                                    <input type="hidden" id="uploads_file" name="uploads_file">
                                    <input type="file" id="modify_file" name="file">
                                </div>
                                <div class="atbd-upload__file">
                                    <ul>
                                        <li>
                                            <a href="#" class="file-name"><i class="las la-paperclip"></i> <span
                                                class="name-text">xxx.png<span></span></span></a>
                                            <a href="#" class="btn-delete"><i class="la la-trash"></i></a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer" style="border: none">
                        <input type="hidden" id="sample_file_id" name="sample_file_id">
                        <button type="button" class="btn btn-secondary btn-sm" onclick="dataToggle('#modify_file', '#sample_file');">취소</button>
                        <button type="button" class="btn btn-primary btn-sm" onclick="modifyFile()">수정</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- 시교자원 데이터 등록 모달창 -->
    <div class="modal-basic modal fade show pop5" id="data_upload" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog modal-md" role="document">
            <div class="modal-content modal-bg-white ">
                <div class="modal-header" style="border: none">
                    <h6 class="modal-title">시교자원관리 > 데이터 등록</h6>
                </div>
                <div class="modal-body">
                    <div class="form-group mb-0" style="justify-content: end">
                        <input type="file" id="excelFile" onchange="excelExport(event)" style="display: none"
                               accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel">
                        <button onclick="filesFunction()">불러오기</button>
                        <input type="file" name="" id="file_data_upload" style="display: none;">
                    </div>
                    <div>
                        <form action="excelSample" id="excelForm" method="POST" enctype="multipart/form-data">
                            <input type="hidden" id="excel_list" name="excel_list">
                            <div class="atbd-upload">
                                <table id="excel_data">
                                    <thead>
                                    <th><span class="title">작물</span></th>
                                    <th><span class="title">시교명(ID)</span></th>
                                    <th><span class="title">목표 지역</span></th>
                                    <th><span class="title">구분</span></th>
                                    <th><span class="title">교배번호</span></th>
                                    <th><span class="title">종자번호(ID)</span></th>
                                    <th><span class="title">현 종자량(g)</span></th>
                                    <th><span class="title">기내 발아율(%)</span></th>
                                    <th><span class="title">기내 순도율(%)</span></th>
                                    <th><span class="title">비고</span></th>
                                    </thead>
                                    <tbody>
                                    </tbody>
                                </table>
                            </div>
                        </form>
                    </div>
                </div>
                <div class="modal-footer" style="border: none">
                    <button type="button" class="btn btn-secondary btn-sm" data-dismiss="modal" onclick="dataToggle('#data_upload', '#data_upload2');">취소</button>
                    <button type="button" class="btn btn-primary btn-sm" data-dismiss="modal" onclick="dataToggle('#data_upload', '#data_upload2'); InsertExcel();">등록</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 수출자원 데이터 등록 모달창 -->
    <div class="modal-basic modal fade show pop5" id="data_upload1" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog modal-md" role="document">
            <div class="modal-content modal-bg-white ">
                <div class="modal-header" style="border: none">
                    <h6 class="modal-title">시교출고관리 > 데이터 등록</h6>
                </div>
                <div class="modal-body">
                    <div class="form-group mb-0" style="justify-content: end">
                        <input type="file" id="excelFile1" onchange="excelExport(event)" style="display: none"
                               accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel">
                        <button onclick="filesFunction()">불러오기</button>
                        <input type="file" name="" id="file_data_upload1" style="display: none;">
                    </div>
                    <div>
                        <form action="excelOutcome" id="excelForm1" method="POST" enctype="multipart/form-data">
                            <input type="hidden" id="excel_list1" name="excel_list1">
                            <div class="atbd-upload">
                                <table id="excel_data1">
                                    <thead>
                                    <th><span class="title">시교명</span></th>
                                    <th><span class="title">종자번호(ID)</span></th>
                                    <th><span class="title">종자 보유량</span></th>
                                    <th><span class="title">입고량</span></th>
                                    <th><span class="title">출고량</span></th>
                                    <th><span class="title">재고량</span></th>
                                    <th><span class="title">담당자</span></th>
                                    <th><span class="title">인수자</span></th>
                                    <th><span class="title">날짜</span></th>
                                    <th><span class="title">시교종료일자</span></th>
                                    <th><span class="title">지역구분</span></th>
                                    <th><span class="title">대상지역</span></th>
                                    </thead>
                                    <tbody>
                                    </tbody>
                                </table>
                            </div>
                        </form>
                    </div>
                </div>
                <div class="modal-footer" style="border: none">
                    <button type="button" class="btn btn-secondary btn-sm" data-dismiss="modal" onclick="dataToggle('#data_upload1', '#data_upload12');">취소</button>
                    <button type="button" class="btn btn-primary btn-sm" data-dismiss="modal" onclick="dataToggle('#data_upload1', '#data_upload12'); InsertExcel();">등록</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 시교자원 데이터 수정 모달창 -->
    <div class="modal-basic modal fade show pop5" id="data_upload3" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog modal-md" role="document">
            <div class="modal-content modal-bg-white ">
                <div class="modal-header" style="border: none">
                    <h6 class="modal-title">시교자원관리 > 데이터 등록</h6>
                </div>
                <div class="modal-body">
                    <div class="form-group mb-0" style="justify-content: end">
                        <input type="file" id="excelFile" onchange="excelExport(event)" style="display: none"
                               accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel">
                        <button onclick="filesFunction()">불러오기</button>
                        <input type="file" name="" id="file_data_upload" style="display: none;">
                    </div>
                    <div>
                        <form action="excelSample" id="excelForm" method="POST" enctype="multipart/form-data">
                            <input type="hidden" id="excel_list" name="excel_list">
                            <div class="atbd-upload">
                                <table id="excel_data">
                                    <thead>
                                    <th><span class="title">작물</span></th>
                                    <th><span class="title">시교명(ID)</span></th>
                                    <th><span class="title">목표 지역</span></th>
                                    <th><span class="title">구분</span></th>
                                    <th><span class="title">교배번호</span></th>
                                    <th><span class="title">종자번호(ID)</span></th>
                                    <th><span class="title">현 종자량(g)</span></th>
                                    <th><span class="title">기내 발아율(%)</span></th>
                                    <th><span class="title">기내 순도율(%)</span></th>
                                    <th><span class="title">비고</span></th>
                                    </thead>
                                    <tbody id="sampleBody">
                                    </tbody>
                                </table>
                            </div>
                        </form>
                    </div>
                </div>
                <div class="modal-footer" style="border: none">
                    <button type="button" class="btn btn-secondary btn-sm" data-dismiss="modal" onclick="dataToggle('#data_upload3', '#data_upload2');">취소</button>
                    <button type="button" class="btn btn-primary btn-sm" data-dismiss="modal" onclick="dataToggle('#data_upload3', '#data_upload2'); InsertExcel();">등록</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 수출자원 데이터 등록 모달창 -->
    <div class="modal-basic modal fade show pop5" id="data_upload13" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog modal-md" role="document">
            <div class="modal-content modal-bg-white ">
                <div class="modal-header" style="border: none">
                    <h6 class="modal-title">시교출고관리 > 데이터 등록</h6>
                </div>
                <div class="modal-body">
                    <div class="form-group mb-0" style="justify-content: end">
                        <input type="file" id="excelFile1" onchange="excelExport(event)" style="display: none"
                               accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel">
                        <button onclick="filesFunction()">불러오기</button>
                        <input type="file" name="" id="file_data_upload1" style="display: none;">
                    </div>
                    <div>
                        <form action="excelOutcome" id="excelForm1" method="POST" enctype="multipart/form-data">
                            <input type="hidden" id="excel_list1" name="excel_list1">
                            <div class="atbd-upload">
                                <table id="excel_data1">
                                    <thead>
                                    <th><span class="title">시교명</span></th>
                                    <th><span class="title">종자번호(ID)</span></th>
                                    <th><span class="title">종자 보유량</span></th>
                                    <th><span class="title">입고량</span></th>
                                    <th><span class="title">출고량</span></th>
                                    <th><span class="title">재고량</span></th>
                                    <th><span class="title">담당자</span></th>
                                    <th><span class="title">인수자</span></th>
                                    <th><span class="title">날짜</span></th>
                                    <th><span class="title">시교종료일자</span></th>
                                    <th><span class="title">지역구분</span></th>
                                    <th><span class="title">대상지역</span></th>
                                    </thead>
                                    <tbody id="outcomeBody">
                                    </tbody>
                                </table>
                            </div>
                        </form>
                    </div>
                </div>
                <div class="modal-footer" style="border: none">
                    <button type="button" class="btn btn-secondary btn-sm" data-dismiss="modal" onclick="dataToggle('#data_upload1', '#data_upload12');">취소</button>
                    <button type="button" class="btn btn-primary btn-sm" data-dismiss="modal" onclick="dataToggle('#data_upload1', '#data_upload12'); InsertExcel();">등록</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 시교자원 데이터 목록 창 -->
    <div class="modal-basic modal fade show pop7" id="data_upload2" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog modal-md" role="document">
            <div class="modal-content modal-bg-white ">
                <div class="modal-header" style="border: none">
                    <h6 class="modal-title">시교자원관리 > 데이터 등록</h6>
                </div>
                <div class="modal-body">
                    <div class="form-group mb-0">
                        <button onclick="dataToggle('#data_upload2', '#data_upload');">데이터 등록</button>
                        <!-- <button type="button" onclick="location.href='/excelTemplate/시교자원관리.xlsx'">등록서식 다운로드</button> -->
                        <button type="button" onclick="location.href='excelTemplate/sampleTemplate.xlsx'">등록서식 다운로드</button>
                    </div>
                    <div>
                        <div class="atbd-upload">
                            <table>
                                <thead>
                                <tr>
                                    <th>순번</th>
                                    <th>등록일</th>
                                    <th>데이터수</th>
                                </tr>
                                </thead>
                                <tbody id="uploadDate">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="modal-footer" style="border: none">
                    <button type="button" class="btn btn-secondary btn-sm" data-dismiss="modal">취소</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 수출관리 데이터 목록 창 -->
    <div class="modal-basic modal fade show pop7" id="data_upload12" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog modal-md" role="document">
            <div class="modal-content modal-bg-white ">
                <div class="modal-header" style="border: none">
                    <h6 class="modal-title">시교출고관리 > 데이터 등록</h6>
                </div>
                <div class="modal-body">
                    <div class="form-group mb-0">
                        <button onclick="dataToggle('#data_upload12', '#data_upload1');">데이터 등록</button>
                        <button type="button" onclick="location.href='/excelTemplate/sampleOutcomeTemplate.xlsx'">등록서식 다운로드</button>
                    </div>
                    <div>
                        <div class="atbd-upload">
                            <table>
                                <thead>
                                <tr>
                                    <th>순번</th>
                                    <th>등록일</th>
                                    <th>데이터수</th>
                                </tr>
                                </thead>
                                <tbody id="uploadDate1">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="modal-footer" style="border: none">
                    <button type="button" class="btn btn-secondary btn-sm" data-dismiss="modal">취소</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 지도 -->
    <div class="modal-basic modal fade show" id="recent" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog modal-md" role="document">
            <div class="modal-content modal-bg-white ">
                <div class="modal-header" style="border: none">
                    <h6 class="modal-title" id="test_click">시교 진행 현황</h6>
                </div>

                <!--
                <select class="form-control form-control-lg mt-10 mb-10 mr-10" style="width: 250px; margin: 1.75rem" id="modal-search">
                    <option value="none">선택</option>
                </select>
                -->

                <div class="modal-body">
                    <ul class="map" id="google_container">
                        <li id="google_map1">
                            <!-- <img src="../assets/vendor_assets/img/map1.png" alt="지도1"> -->
                        </li>
                        <li id="google_map2"><!--<img src="../assets/vendor_assets/img/map2.png" alt="지도2">--></li>
                    </ul>
                </div>

                <div class="modal-footer" style="border: none">
                    <button type="button" class="btn btn-secondary btn-sm" data-dismiss="modal">
                        취소
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- 시교명 팝업 -->
    <div class="modal-basic modal show pop7" id="pop_breed" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog modal-md" role="document">
            <div class="modal-content modal-bg-white">
                <div class="modal-header" style="border: none">
                    <h6 class="modal-title">시교자원관리 > 품종관리</h6>
                    <span class="breed_title"></span>
                </div>
                <div class="modal-body">
                    <div>
                        <!--
                        <input type='button' class='btn btn-inverse' value='excel 다운' style='width:100px;height:36px;font-weight:bold;' onclick="ReportToExcelConverter()" />
                        -->
                        <div class="atbd-upload popAdd tab-pane fade show active" id="tab-horizontal-0-0" role="tabpanel" aria-labelledby="tab-horizontal-0-tab-0"
                             style=" overflow: auto; max-height: 500px;">
                            <div class='card-extra mt-10 mb-10 mr-20 plus_btn_submit3'>
                                <button type='button' id="cancelRow1" onclick="cancelRow1()">취소</button>
                                <button type='button' id="saveRow1" onclick="saveRow1()">저장</button>
                            </div>
                            <div class='card-extra mt-10 mb-10 mr-20 plus_btn_submit4'>
                                <button type='button' id="cancelUpdate1" onclick="cancelUpdate1()">취소</button>
                                <button type='button' id="updateRow1" onclick="updateRow1()">수정</button>
                            </div>
                            <div class="card-body" style="padding-top: 0;">
                                <div class="bg-white">
                                    <div id="breedGrid2"></div>
                                    <div class="row">
                                        <div class="col-4" id="btn1">
                                            <button class="btn btn-icon btn-light btn-circle" onclick="insertRow1()">
                                                <span data-feather="plus"></span>
                                            </button>
                                            <button class="btn btn-icon btn-light btn-circle" onclick="DeleteBreed1()">
                                                <span data-feather="trash-2"></span>
                                            </button>

                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer" style="border: none">
                </div>
            </div>
        </div>
    </div>

    <!-- 종자번호 팝업 -->
    <div class="modal-basic modal show pop7" id="pop_seed" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog modal-md" role="document">
            <div class="modal-content modal-bg-white">
                <div class="modal-header" style="border: none">
                    <h6 class="modal-title">시교출고관리</h6>
                    <span class="seed_title"></span>
                </div>
                <div class="modal-body">
                    <div>
                        <!--
                        <input type='button' class='btn btn-inverse' value='excel 다운' style='width:100px;height:36px;font-weight:bold;' onclick="ReportToExcelConverter()" />
                        -->
                        <div class="atbd-upload">
                            <div class='card-extra mt-10 mb-10 mr-20 plus_btn_submit5'>
                                <button type='button' id="cancelRow2" onclick="cancelRow2()">취소</button>
                                <button type='button' id="saveRow2" onclick="saveRow2()">저장</button>
                            </div>
                            <div class='card-extra mt-10 mb-10 mr-20 plus_btn_submit6'>
                                <button type='button' id="cancelUpdate2" onclick="cancelUpdate2()">취소</button>
                                <button type='button' id="updateRow2" onclick="updateRow2()">수정</button>
                            </div>
                            <div class="card-body" style="padding-top: 0;">
                                <div class="bg-white">
                                    <div id="outcomeGrid2"></div>
                                    <div class="row">
                                        <div class="col-4" id="btn1">
                                            <button class="btn btn-icon btn-light btn-circle" onclick="insertRow2()">
                                                <span data-feather="plus"></span>
                                            </button>
                                            <button class="btn btn-icon btn-light btn-circle" onclick="DeleteSample1()">
                                                <span data-feather="trash-2"></span>
                                            </button>

                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer" style="border: none">
                </div>
            </div>
        </div>
    </div>

    <!-- modal end -->

    <div class="load_wrap">
        <div class="load">
            <h2>잠시만 기다려주세요</h2>
            <div class="loader"></div>
        </div>
    </div>

</main>

<!-- 공통 하단 -->
<th:block th:include="/../fragments/footer.html"></th:block>
<!-- 공통 js -->
<th:block th:include="/../fragments/commonjs.html"></th:block>

<script type="text/javascript">
    function dataToggle(one, two) {
        $(one).modal("hide");

        setTimeout(function () {
            $(two).modal("show");
        }, 5);
    }

    /* s : localstorage 저장 예제 */
    function setLocalS(key, value) {
        localStorage.setItem(key, value);
    }

    function getLocalS(key, useRemove) {
        let result = "";
        if (localStorage.getItem(key) !== null) {
            result = localStorage.getItem(key);
            if (useRemove) {
                removeLocalS(key);
            }
            return result;
        } else {
            result = "고추"
            return result;
        }
    }

    function removeLocalS(key) {
        localStorage.removeItem(key);
    }

    /* e : localstorage 저장 예제 */

    /* 엑셀 업로드 목록창 */
    function filesFunction() {
        if (tablechk === 0) {
            let filesBtn = document.getElementById("excelFile");
            let eventList = document.createEvent("MouseEvent");

            eventList.initEvent("click");
            filesBtn.dispatchEvent(eventList);
        } else {
            let filesBtn = document.getElementById("excelFile1");
            let eventList1 = document.createEvent("MouseEvent");

            eventList1.initEvent("click");
            filesBtn.dispatchEvent(eventList1);
        }
    }

    /* 엑셀 업로드 목록창 */

    /* 엑셀 코드 */
    function handleExcelDataAll(sheet) {
        handleExcelDataHtml(sheet); // html 형태
    }

    /* Html 형태로 출력 */
    function handleExcelDataHtml(sheet) {
        $("#displayExcelHtml").html(XLSX.utils.sheet_to_html(sheet));
    }

    function excelExport(event) {
        excelExportCommon(event, handleExcelDataAll);
    }

    function excelExportCommon(event, callback) {
        if (tablechk == 0) {
            let input = event.target;
            let reader = new FileReader();

            reader.onload = function () {
                let fileData = reader.result;
                let wb = XLSX.read(fileData, {type: 'binary'});
                let sheetNameList = wb.SheetNames; // 시트 이름 목록 가져오기
                let fourthSheetName = sheetNameList[0]; // 네번째 시트명
                let fourthSheet = wb.Sheets[fourthSheetName]; // 네번째 시트
                callback(fourthSheet);

                delete fourthSheet.A1;
                delete fourthSheet.A2;
                let rowdata = XLSX.utils.sheet_to_json(fourthSheet);

                let keys = Object.values(rowdata[0]);

                let html = "";

                for (let i = 1; i < rowdata.length; i++) {
                    if (i === 0) {
                        html += "<thead class='text-center'>";
                        html += "<tr>";

                        $.each(rowdata[0], function (idx, value) {
                            html += "<th><span class='excel-title'>" + value + "</span></th>";
                        })

                        html += "</tr>";
                        html += "</thead>";
                    } else if (i !== 0) {
                        html += "<tbody class='text-center'>";
                        html += "<tr>";

                        let tmp = Object.keys(rowdata[0]);
                        let j = 0;

                        $.each(rowdata[i], function (idx, value) {
                            // 공백처리
                            if (idx == tmp[j]) {

                                html += "<td class='excel'><span>" + value + "</span></td>";
                                j++;

                            } else {
                                let idx_str = idx.replace(/[^0-9]/g, '');
                                let tmp_str = tmp[j].replace(/[^0-9]/g, '');

                                let gap = idx_str - tmp_str;

                                while (gap > 0) {
                                    gap--;
                                    html += "<td><span> </span></td>";
                                }

                                html += "<td class='excel'><span>" + value + "</span></td>";
                                j++;

                                j = idx_str;
                                j++;
                            }
                        });

                        html += "</tr>";
                        html += "</tbody>";
                    }
                }

                let excel = [];

                for (let k = 1; k < rowdata.length; k++) {
                    let chk = Object.values(rowdata[k]);

                    for (let n = 0; n < keys.length; n++) {
                        if (chk[n] == undefined) {
                            excel[n] = {key: keys[n], value: " "};
                        } else if (keys[n] === "도입연월일") {
                            excel[n] = {key: keys[n], value: excelDateToJSDate(chk[n])};
                        } else {
                            excel[n] = {key: keys[n], value: "" + chk[n]};
                        }
                    }
                    const obj = {...excel};

                    rowdata[k] = obj;
                }
                // $("#excel_data").empty();
                $("#excel_data").append(html);

                let jsonObj = tableToJson(document.getElementById("excel_data"));

                $("#excel_list").val(JSON.stringify(jsonObj));
            };

            reader.readAsBinaryString(input.files[0]);
        } else {
            let input1 = event.target;
            let reader1 = new FileReader();

            reader1.onload = function () {
                let fileData = reader1.result;
                let wb = XLSX.read(fileData, {type: 'binary'});
                let sheetNameList = wb.SheetNames; // 시트 이름 목록 가져오기

                let sheetName_ten = sheetNameList[0]; // 네번째 시트명
                let tenSheet = wb.Sheets[sheetName_ten]; // 네번째 시트
                callback(tenSheet);

                delete tenSheet.A1;
                let rowdata = XLSX.utils.sheet_to_json(tenSheet);

                let keys = Object.values(rowdata[0]);

                let html = "";

                for (let i = 0; i < rowdata.length; i++) {
                    if (i === 0) {
                        html += "<thead class='text-center'>";
                        html += "<tr>";

                        $.each(rowdata[0], function (idx, value) {
                            html += "<th><span class='excel-title'>" + value + "</span></th>";
                        })

                        html += "</tr>";
                        html += "</thead>";
                    } else if (i !== 0) {
                        html += "<tbody class='text-center'>";
                        html += "<tr>";

                        let tmp = Object.keys(rowdata[0]);
                        let j = 0;

                        $.each(rowdata[i], function (idx, value) {
                            // 공백처리
                            if (idx == tmp[j]) {
                                if (idx == "__EMPTY_8" || idx == "__EMPTY_9") {
                                    html += "<td class='excel'><span>" + excelDateToJSDate(value) + "</span></td>";
                                    j++;
                                } else {
                                    html += "<td class='excel'><span>" + value + "</span></td>";
                                    j++;
                                }

                            } else {
                                let idx_str = idx.replace(/[^0-9]/g, '');
                                let tmp_str = tmp[j].replace(/[^0-9]/g, '');

                                let gap = idx_str - tmp_str;

                                while (gap > 0) {
                                    gap--;
                                    html += "<td><span> </span></td>";
                                }

                                if (idx == "__EMPTY_8" || idx == "__EMPTY_9") {
                                    html += "<td class='excel'><span>" + excelDateToJSDate(value) + "</span></td>";
                                    j++;
                                } else {
                                    html += "<td class='excel'><span>" + value + "</span></td>";
                                    j++;
                                }

                                j = idx_str;
                                j++;
                            }
                        });

                        html += "</tr>";
                        html += "</tbody>";
                    }
                }

                let excel = [];

                for (let k = 1; k < rowdata.length; k++) {
                    let chk = Object.values(rowdata[k]);

                    for (let n = 0; n < keys.length; n++) {
                        if (chk[n] == undefined) {
                            excel[n] = {key: keys[n], value: " "};
                        } else if (keys[n] === "일자") {
                            excel[n] = {key: keys[n], value: excelDateToJSDate(chk[n])};
                        } else if (keys[n] === "시교 종료 일자") {
                            excel[n] = {key: keys[n], value: excelDateToJSDate(chk[n])};
                        } else {
                            excel[n] = {key: keys[n], value: "" + chk[n]};
                        }
                    }
                    const obj = {...excel};

                    rowdata[k] = obj;
                }

                $("#excel_data1").empty();
                $("#excel_data1").append(html);
            };

            reader1.readAsBinaryString(input1.files[0]);
        }
    }

    /* 엑셀 등록 창 */
    function openExcel() {
        let user_type = $("#user_type").val();

        if (user_type != 0 && user_type != 2) {
            return Alert("등록 권한이 없습니다.");
        } else {
            if (tablechk === 0) {
                $("#data_upload2").modal();

                let data = {"datalist_type": 'sample'};

                $.ajax(
                    {
                        url: 'selectSampleDateGroup',
                        method: 'POST',
                        dataType: 'json',
                        data: data,
                        success: function (result) {
                            let data_list = $("#uploadDate");
                            let data_add = "";

                            for (let i = result.dataGroup.length - 1; i > -1; i--) {
                                let date = result.dataGroup[i].datalist_date;

                                let resultArr = date.split('-');
                                let resultDate = "";

                                for (let j = 0; j < resultArr.length; j++) {
                                    resultDate += resultArr[j];
                                }

                                data_add += '<tr>';
                                data_add += '<td>' + (i + 1) + '</td>';
                                data_add += '<td><button onclick="ModifyDataBtn(' + resultDate + ')" style="border:0px; color:blue; background: white;">' + result.dataGroup[i].datalist_date + '</button></td>';
                                data_add += '<td>' + result.dataGroup[i].cnt + '</td>';
                                data_add += '</tr>';
                            }

                            data_list.empty();
                            data_list.append(data_add);
                        }
                    });
            } else {
                $("#data_upload12").modal();

                let data = {"datalist_type": 'sample_outcome'};

                $.ajax(
                    {
                        url: 'selectDateGroup',
                        method: 'POST',
                        dataType: 'json',
                        data: data,
                        success: function (result) {
                            let data_list = $("#uploadDate1");
                            let data_add = "";

                            for (let i = result.dataGroup.length - 1; i > -1; i--) {
                                let date = result.dataGroup[i].datalist_date;

                                let resultArr = date.split('-');
                                let resultDate = "";

                                for (let j = 0; j < resultArr.length; j++) {
                                    resultDate += resultArr[j];
                                }

                                data_add += '<tr>';
                                data_add += '<td>' + (i + 1) + '</td>';
                                data_add += '<td><button onclick="ModifyDataBtn(' + resultDate + ')" style="border:0px; color:blue; background: white;">' + result.dataGroup[i].datalist_date + '</button></td>';
                                data_add += '<td>' + result.dataGroup[i].cnt + '</td>';
                                data_add += '</tr>';
                            }

                            data_list.empty();
                            data_list.append(data_add);
                        }
                    }
                );
            }
        }
    }

    /* 엑셀 등록 창 */
    function ModifyDataBtn(e) {
        if (tablechk == 0) {
            let s = String(e);
            s = s.replace(/(\d{4})(\d{2})(\d{2})/g, '$1-$2-$3');

            let data = {"datalist_date": s};

            $.ajax(
                {
                    url: 'searchTarget',
                    method: 'POST',
                    dataType: 'json',
                    data: data,
                    success: function (result) {
                        if (result != null) {
                            $("#data_upload3").modal("show");
                            $("#data_upload2").modal("hide");

                            let sample_list = $("#sampleBody");
                            let add_list = "";

                            let len = Object.keys(result.sample).length;

                            for (let i = 0; i < len; i++) {
                                add_list += '<tr>';
                                add_list += '<td>' + result.sample[i][0].sample_name + '</td>';
                                add_list += '<td>' + result.sample[i][0].sample_code + '</td>';
                                add_list += '<td>' + result.sample[i][0].sample_country + '</td>';
                                add_list += '<td>' + result.sample[i][0].sample_type + '</td>';
                                add_list += '<td>' + result.sample[i][0].sample_mate + '</td>';
                                add_list += '<td>' + result.sample[i][0].sample_seed + '</td>';
                                add_list += '<td>' + result.sample[i][0].sample_amount + '</td>';
                                add_list += '<td>' + result.sample[i][0].sample_sprout + '</td>';
                                add_list += '<td>' + result.sample[i][0].sample_purity + '</td>';
                                add_list += '<td>' + result.sample[i][0].sample_comment + '</td>';
                                add_list += '</tr>';
                            }

                            sample_list.empty();
                            sample_list.append(add_list);
                        }
                    }
                }
            );
        } else {
            let s = String(e);
            s = s.replace(/(\d{4})(\d{2})(\d{2})/g, '$1-$2-$3');

            let data = {"datalist_date": s};

            $.ajax(
                {
                    url: 'searchTargetOutcome',
                    method: 'POST',
                    dataType: 'json',
                    data: data,
                    success: function (result) {
                        if (result != null) {
                            $("#data_upload13").modal("show");
                            $("#data_upload12").modal("hide");

                            let sample_list = $("#outcomeBody");
                            let add_list = "";

                            let len = Object.keys(result.sample_outcome).length;

                            for (let i = 0; i < len; i++) {
                                add_list += '<tr>';
                                add_list += '<td>' + result.sample_outcome[i][0].sample_outcome_code + '</td>';
                                add_list += '<td>' + result.sample_outcome[i][0].sample_outcome_num + '</td>';
                                add_list += '<td>' + result.sample_outcome[i][0].sample_outcome_amount + '</td>';
                                add_list += '<td>' + result.sample_outcome[i][0].sample_outcome_in + '</td>';
                                add_list += '<td>' + result.sample_outcome[i][0].sample_outcome_out + '</td>';
                                add_list += '<td>' + result.sample_outcome[i][0].sample_outcome_remain + '</td>';
                                add_list += '<td>' + result.sample_outcome[i][0].sample_outcome_person + '</td>';
                                add_list += '<td>' + result.sample_outcome[i][0].sample_outcome_reciever + '</td>';
                                add_list += '<td>' + result.sample_outcome[i][0].sample_outcome_date + '</td>';
                                add_list += '<td>' + result.sample_outcome[i][0].sample_outcome_end + '</td>';
                                add_list += '<td>' + result.sample_outcome[i][0].sample_outcome_country + '</td>';
                                add_list += '<td>' + result.sample_outcome[i][0].sample_outcome_place + '</td>';
                                add_list += '</tr>';
                            }

                            sample_list.empty();
                            sample_list.append(add_list);
                        }
                    }
                }
            );
        }

    }

    let now = null;

    /* 엑셀 입력 */
    async function InsertExcel() {
        if (tablechk === 0) {
            let data = [];

            $("#excel_data").each(function (index, item) {
                const key = $(this).attr('id');
                let value = $(this).val();

                let arr = {key: key, value: value};

                data.push(arr);
            });

            let jsonObj = tableToJson(document.getElementById("excel_data"));

            $.ajax(
                {
                    url: 'excelSample',
                    method: 'POST',
                    dataType: 'json',
                    data: {
                        "excel_list": JSON.stringify(jsonObj)
                    },
                    success: function (result) {
                        now = new Date(+new Date() + 3240 * 10000).toISOString().split("T")[0];

                        let listData = [];

                        let sample_name = $("#CropSelect").val();

                        let lData = {"datalist_type": 'sample', "datalist_date": now, "sample_name": sample_name};

                        listData.push(lData);

                        $.ajax(
                            {
                                url: 'insertSampleDataList',
                                method: 'POST',
                                dataType: 'json',
                                data: {
                                    "listData": JSON.stringify(listData)
                                },
                                success: function (result) {
                                    location.reload();
                                }
                            })
                    }
                }
            )
        } else {
            let data1 = [];

            $("#excel_data1").each(function (index, item) {
                const key = $(this).attr('id');
                let value = $(this).val();

                let arr = {key: key, value: value};

                data1.push(arr);
            });

            let jsonObj = tableToJson(document.getElementById("excel_data1"));

            for (let i = 0; i < jsonObj.length; i++) {
                jsonObj[i]["작물"] = $("#CropSelect").val();
            }

            var geoCoder = new google.maps.Geocoder();

            for await (const item of jsonObj) {
                if(item['대상 지역']){
                    let placement = item["대상 지역"];

                    await geoCoder.geocode({"address": placement}, function (result, status) {
                        if (status == "OK") {
                            item["lat"] = result[0].geometry.location.lat();
                            item["lng"] = result[0].geometry.location.lng();
                            console.log("in", item);
                        }
                    });
                }
            }

            $.ajax(
                {
                    url: 'excelOutcome',
                    method: 'POST',
                    dataType: 'json',
                    data: {
                        "excel_list": JSON.stringify(jsonObj)
                    },
                    success: function (result) {
                        if (result == 0) {
                            return Alert1("데이터 입력에 실패했습니다.");
                        } else {
                            now = new Date(+new Date() + 3240 * 10000).toISOString().split("T")[0];

                            let listData = [];

                            let sample_name = $("#CropSelect").val();

                            let lData = {"datalist_type": 'sample_outcome', "datalist_date": now, "sample_name": sample_name};

                            listData.push(lData);

                            $.ajax(
                                {
                                    url: 'insertOutcomeDataList',
                                    method: 'POST',
                                    dataType: 'json',
                                    data: {
                                        "listData": JSON.stringify(listData)
                                    },
                                    success: function (result) {
                                        location.reload();
                                    }
                                })
                        }

                    }
                }
            )
        }
    }

    /* 엑셀 코드 */

    // table to json
    function tableToJson(table) {
        let data = [];

        let headers = [];
        for (let i = 0; i < table.rows[0].cells.length; i++) {
            headers[i] = table.rows[0].cells[i].innerText;
        }

        for (let i = 1; i < table.rows.length; i++) {
            let tableRow = table.rows[i];

            let rowData = {};

            for (let j = 0; j < tableRow.cells.length; j++) {
                rowData[headers[j]] = tableRow.cells[j].innerText;
            }

            data.push(rowData);
        }

        return data;
    }

    // table to json

    // date to string
    function excelDateToJSDate(excelDate) {
        let date = new Date(Math.round((excelDate - (25567 + 2)) * 86400 * 1000)),
            m = '' + (date.getMonth() + 1),
            d = '' + date.getDate(),
            y = date.getFullYear();

        if (m.length < 2) {
            m = '0' + m;
        }

        if (d.length < 2) {
            d = '0' + d;
        }

        return [y, m, d].join('-');
    }

    /* form data to json */
    jQuery.fn.serializeObject = function () {
        let obj = null;
        try {
            if (this[0].tagName && this[0].tagName.toUpperCase() == "FORM") {
                let arr = this.serializeArray();
                if (arr) {
                    obj = {};
                    jQuery.each(arr, function () {
                        obj[this.name] = this.value;
                    });
                }
            }
        } catch (e) {
            alert(e.message);
        } finally {
        }

        return obj;
    };
    /* form data to json */

    const thisBtn = document.querySelector('#modal_open');

    /* 시교자원 수출관리 테이블 구분 */
    let tablechk = 0;

    $("#sampleTable1").click(function () {
        tablechk = 0;
        outcomegrid.destroy();
        $("#CropSelect").val(getLocalS("sample_crop"));

        SearchSample(1);
    })

    $("#sampleTable2").click(function () {
        tablechk = 1;
        samplegrid.destroy();
        $("#CropSelect").val(getLocalS("sample_crop"));

        SearchOutcome(1);
    })
    /* 시교자원 수출관리 테이블 구분 */

    // DB에 저장된 데이터 읽어와서 테이블에 보여줌
    $(document).ready(function () {
        $("#CropSelect").val(getLocalS("sample_crop"));

        SearchSample(1);
        SearchMarker();

        $(".plus_btn_submit1").css("display", "none");
        $(".plus_btn_submit2").css("display", "none");
        $(".plus_btn_submit3").css("display", "none");
        $(".plus_btn_submit4").css("display", "none");
        $(".plus_btn_submit5").css("display", "none");
        $(".plus_btn_submit6").css("display", "none");
    });

    $("#CropSelect").change(function () {
        if (tablechk == 0) {
            samplegrid.destroy();

            SearchSample(1);
        } else {
            outcomegrid.destroy();

            SearchOutcome(1);
        }

        setLocalS("sample_crop", $("#CropSelect").val());

        $(".plus_btn_submit1").css("display", "none");
        $(".plus_btn_submit2").css("display", "none");
        $(".plus_btn_submit3").css("display", "none");
        $(".plus_btn_submit4").css("display", "none");
        $(".plus_btn_submit5").css("display", "none");
        $(".plus_btn_submit6").css("display", "none");
    })

    // 갯수 선택
    $("#limit").change(function () {
        if (tablechk == 0) {
            samplegrid.destroy();

            SearchSample(1);
        } else {
            outcomegrid.destroy();

            SearchOutcome(1);
        }

        $(".plus_btn_submit1").css("display", "none");
        $(".plus_btn_submit2").css("display", "none");
        $(".plus_btn_submit3").css("display", "none");
        $(".plus_btn_submit4").css("display", "none");
        $(".plus_btn_submit5").css("display", "none");
        $(".plus_btn_submit6").css("display", "none");
    })

    function selectAll(selectAll) {
        if (tablechk === 0) {
            const checkboxes
                = document.getElementsByName('RowCheck');

            checkboxes.forEach((checkbox) => {
                checkbox.checked = selectAll.checked;
            })
        } else {
            const checkboxes1
                = document.getElementsByName('RowCheck1');

            checkboxes1.forEach((checkbox) => {
                checkbox.checked = selectAll.checked;
            })
        }
    }

    let emptyEls;

    // 종자번호 팝업
    function SearchSeed(e) {
        $("#pop_seed").modal();

        tablechk = 3;

        let sample_name1 = $("#CropSelect").val();
        var limit3 = $("#limit").val();

        let data1 = {"sample_name": sample_name1};

        var loading = document.querySelector('.load_wrap');

        loading.classList.add('on');

        $.ajax(
            {
                url: 'searchSeed',
                method: 'POST',
                dataType: 'json',
                data: data1,
                success: function (result3) {
                    $(".seed_title").text("종자번호(ID) - " + e.innerText);

                    outcomeGrid2 = new tui.Grid({
                        el: document.getElementById('outcomeGrid2'),
                        scrollX: true,
                        scrollY: true,
                        data: result3.sampleOutcome,
                        rowHeaders: ['checkbox'],
                        columns: [
                            {
                                header: '시교명',
                                name: 'sample_outcome_code',
                                editor: 'text',
                                sortable: true,
                                width: 180,
                                filter: {type: 'text', showApplyBtn: true, showClearBtn: true}
                            },
                            {
                                header: '종자번호(ID)',
                                name: 'sample_outcome_num',
                                editor: 'text',
                                sortable: true,
                                width: 180,
                                filter: 'number'
                            },
                            {
                                header: '종자 보유량',
                                name: 'sample_outcome_amount',
                                editor: 'text',
                                sortable: true,
                                width: 180,
                                filter: 'number'
                            },
                            {
                                header: '입고량',
                                name: 'sample_outcome_in',
                                editor: 'text',
                                sortable: true,
                                width: 180,
                                filter: 'number'
                            },
                            {
                                header: '출고량',
                                name: 'sample_outcome_out',
                                editor: 'text',
                                sortable: true,
                                width: 180,
                                filter: 'number'
                            },
                            {
                                header: '재고량',
                                name: 'sample_outcome_remain',
                                editor: 'text',
                                sortable: true,
                                width: 180,
                                filter: 'number'
                            },
                            {
                                header: '담당자',
                                name: 'sample_outcome_person',
                                editor: 'text',
                                width: 180,
                                filter: {type: 'text', showApplyBtn: true, showClearBtn: true},
                                sortable: true
                            },
                            {
                                header: '인수자',
                                name: 'sample_outcome_reciever',
                                editor: 'text',
                                width: 180,
                                filter: {type: 'text', showApplyBtn: true, showClearBtn: true},
                                sortable: true
                            },
                            {
                                header: '날짜',
                                name: 'sample_outcome_date',
                                editor: 'text',
                                width: 180,
                                filter: 'date',
                                sortable: true
                            },
                            {
                                header: '시교종료일자',
                                name: 'sample_outcome_end',
                                editor: 'text',
                                width: 180,
                                filter: 'date',
                                sortable: true
                            },
                            {
                                header: '지역 구분',
                                name: 'sample_outcome_country',
                                editor: 'text',
                                sortable: true,
                                width: 180,
                                filter: {type: 'text', showApplyBtn: true, showClearBtn: true}
                            },
                            {
                                header: '대상 지역',
                                name: 'sample_outcome_place',
                                editor: 'text',
                                sortable: true,
                                width: 180,
                                filter: {type: 'text', showApplyBtn: true, showClearBtn: true}
                            }

                        ],
                        pageOptions: {
                            useClient: false,
                            perPage: limit3
                        }

                    });

                    const dataArr = [];
                    const dataArr2 = [];

                    for (let i = 0; i < result3.sampleOutcome.length; i++) {
                        if (result3.sampleOutcome[i].sample_outcome_num === e.innerText) {

                            let rowArr = {
                                'sample_outcome_id': result3.sampleOutcome[i].sample_outcome_id,
                                'sample_outcome_code': result3.sampleOutcome[i].sample_outcome_code,
                                'sample_outcome_num': result3.sampleOutcome[i].sample_outcome_num,
                                'sample_outcome_amount': result3.sampleOutcome[i].sample_outcome_amount,
                                'sample_outcome_in': result3.sampleOutcome[i].sample_outcome_in,
                                'sample_outcome_out': result3.sampleOutcome[i].sample_outcome_out,
                                'sample_outcome_remain': result3.sampleOutcome[i].sample_outcome_remain,
                                'sample_outcome_person': result3.sampleOutcome[i].sample_outcome_person,
                                'sample_outcome_reciever': result3.sampleOutcome[i].sample_outcome_reciever,
                                'sample_outcome_date': result3.sampleOutcome[i].sample_outcome_date,
                                'sample_outcome_end': result3.sampleOutcome[i].sample_outcome_end,
                                'sample_outcome_country': result3.sampleOutcome[i].sample_outcome_country,
                                'sample_outcome_place': result3.sampleOutcome[i].sample_outcome_place
                            }

                            dataArr2.push(rowArr);

                        }

                    }

                    for (let j = dataArr2.length - 1; j >= 0; j--) {
                        let rowArr2 = {
                            'sample_outcome_id': dataArr2[j].sample_outcome_id,
                            'sample_outcome_code': dataArr2[j].sample_outcome_code,
                            'sample_outcome_num': dataArr2[j].sample_outcome_num,
                            'sample_outcome_amount': dataArr2[j].sample_outcome_amount,
                            'sample_outcome_in': dataArr2[j].sample_outcome_in,
                            'sample_outcome_out': dataArr2[j].sample_outcome_out,
                            'sample_outcome_remain': dataArr2[j].sample_outcome_remain,
                            'sample_outcome_person': dataArr2[j].sample_outcome_person,
                            'sample_outcome_reciever': dataArr2[j].sample_outcome_reciever,
                            'sample_outcome_date': dataArr2[j].sample_outcome_date,
                            'sample_outcome_end': dataArr2[j].sample_outcome_end,
                            'sample_outcome_country': dataArr2[j].sample_outcome_country,
                            'sample_outcome_place': dataArr2[j].sample_outcome_place
                        }
                        dataArr.push(rowArr2);
                    }

                    outcomeGrid2.resetData(dataArr);

                    let before = null;
                    let after = null;

                    outcomeGrid2.on('dblclick', (ev) => {
                        ev.stop();
                    })

                    outcomeGrid2.on('editingStart', (ev) => {
                        if ($(".plus_btn_submit5")[0].style.display != 'block') {
                            $(".plus_btn_submit6").css("display", "block");
                        }
                    })

                    outcomeGrid2.on('afterChange', (ev) => {
                        let user_type = $("#user_type").val();

                        if (user_type != 0 && user_type != 2) {
                            return Alert("수정 권한이 없습니다.");
                            location.reload();
                        } else {
                            for (let i = 0; i < ev.changes.length; i++) {
                                before = ev.changes[i].prevValue;
                                after = ev.changes[i].value;

                                if (after != before) {
                                    let sample_outcome_id = outcomeGrid2.getRow(ev.changes[i].rowKey).sample_outcome_id
                                    let sample_outcome_name = ev.changes[i].columnName;
                                    let sample_outcome_value = after;

                                    if (sample_outcome_id != null) {
                                        updateOutcomeData.push({
                                            "sample_outcome_id": sample_outcome_id,
                                            "sample_outcome_name": sample_outcome_name,
                                            "sample_outcome_value": sample_outcome_value
                                        });
                                    }
                                }

                                if ($(".plus_btn_submit5")[0].style.display != 'block') {
                                    $(".plus_btn_submit6").css("display", "block");
                                }
                            }
                        }
                    });

                    loading.classList.remove('on');

                }
            });

        $("#pop_seed").on('hidden.bs.modal', function (e) {
            tablechk = 0;
            outcomeGrid2.destroy();
            samplegrid.reload();

            SearchSample(1);
        })
    }

    // 시교명 팝업
    function SearchBreed(e) {
        $("#pop_breed").modal();

        tablechk = 2;

        let breed_name = $("#CropSelect").val();
        var limit = $("#limit").val();
        let data = {"breed_name": breed_name};

        var loading = document.querySelector('.load_wrap');

        $.ajax(
            {
                url: 'searchBreedList',
                method: 'POST',
                dataType: 'json',
                data: data,
                success: function (result2) {
                    $(".breed_title").text("시교명 (ID) : " + e.innerText);

                    breedGrid2 = new tui.Grid({
                        el: document.getElementById('breedGrid2'),
                        scrollX: true,
                        scrollY: true,
                        data: result2.breed,
                        rowHeaders: ['checkbox'],
                        columns: [],
                        pageOptions: {
                            useClient: false,
                            perPage: limit
                        }
                    });

                    // header
                    const header_add = [];
                    var headerName = [];

                    for (let i = 0; i < result2.detail.length; i++) {
                        var colHeader = result2.detail[i].detail_title;
                        var colName = result2.detail[i].detail_id;
                        headerName[i] = result2.detail[i].detail_id;

                        var title_arr = {};

                        var filter = {type: 'text', showApplyBtn: true, showClearBtn: true};

                        if (result2.detail[i].detail_title != '첨부파일 관리') {
                            let title_arr = {
                                'header': colHeader,
                                'name': colName,
                                'editor': 'text',
                                'sortable': 'true',
                                'width': 180,
                                'filter': filter
                            }
                            header_add.push(title_arr);
                        }

                    }

                    breedGrid2.setColumns(header_add);
                    const dataArr = [];
                    const dataArr2 = [];

                    for (let i = 0; i < result2.breed.length; i++) {

                        let rowArr = {};

                        if (result2.breeds[i].breed_standard[1].standard === e.innerText) {

                            rowArr = {'breed_id': result2.breed[i].breed_id};


                            for (var j = 0; j < result2.breed[i].breed_standard.length; j++) {
                                var rowData = result2.breed[i].breed_standard[j].standard;
                                rowArr[headerName[j]] = rowData;
                            }

                            dataArr.push(rowArr);

                        }

                    }

                    breedGrid2.resetData(dataArr);

                    breedGrid2.on('check', (ev) => {
                        breedGrid2.getRow(ev.rowKey).breed_id;
                    })

                    breedGrid2.on('editingStart', (ev) => {
                        if ($(".plus_btn_submit3")[0].style.display != 'block') {
                            $(".plus_btn_submit4").css("display", "block");
                        }
                    })

                    let before = null;
                    let after = null;

                    breedGrid2.on('afterChange', (ev) => {
                        var user_type = $("#user_type").val();

                        if (user_type != 0 && user_type != 2) {
                            return Alert("수정 권한이 없습니다.");
                        } else {
                            for (let i = 0; i < ev.changes.length; i++) {
                                before = ev.changes[i].prevValue;
                                after = ev.changes[i].value;

                                if (after != before) {
                                    var breed_id = breedGrid2.getRow(ev.changes[i].rowKey).breed_id;
                                    var detail_id = ev.changes[i].columnName;
                                    var standard = after;

                                    if (breed_id != null) {
                                        updateBreedData.push({"breed_id": breed_id, "detail_id": detail_id, "standard": standard});
                                    }
                                }

                                if ($(".plus_btn_submit3")[0].style.display != 'block') {
                                    $(".plus_btn_submit4").css("display", "block");
                                }
                            }
                        }
                    });

                    loading.classList.remove('on');
                }
            });

        $("#pop_breed").on('hidden.bs.modal', function (e) {
            tablechk = 0;
            breedGrid2.destroy();
            samplegrid.reload();


            SearchSample(1);
        })

    }


    // 시교자원 삭제
    function DeleteSample() {
        let user_type = $("#user_type").val();

        if (user_type != 0) {
            return Alert("삭제 권한이 없습니다.");
        } else {
            if (tablechk === 0) {
                let total_id = [];

                let l = samplegrid.getCheckedRows().length;

                for (let i = 0; i < l; i++) {
                    total_id.push(samplegrid.getCheckedRows()[i].sample_id)
                }

                let data = {'sample_id': total_id};

                if (confirm("삭제하시겠습니까?") == true) {
                    $.ajax(
                        {
                            url: 'deleteSample',
                            method: 'POST',
                            dataType: 'json',
                            data: data,
                            success: function (result) {
                                if (result == 0) {
                                    return Alert("삭제에 실패하였습니다.");
                                } else {
                                    location.reload()
                                }
                            }
                        });
                } else {
                    return false;
                }
            } else {
                let total_id1 = [];

                let l1 = outcomegrid.getCheckedRows().length;

                for (let i = 0; i < l1; i++) {
                    total_id1.push(outcomegrid.getCheckedRows()[i].sample_outcome_id)
                }

                let data1 = {'sample_outcome_id': total_id1};

                if (confirm("삭제하시겠습니까?") == true) {
                    $.ajax(
                        {
                            url: 'deleteOutcome',
                            method: 'POST',
                            dataType: 'json',
                            data: data1,
                            success: function (result) {
                                if (result == 0) {
                                    return Alert("삭제에 실패하였습니다.");
                                } else {
                                    location.reload()
                                }
                            }
                        });
                } else {
                    return false;
                }
            }
        }
    }

    // 시교자원 삭제

    /* 첨부파일 */
    function FileBtn(e) {
        $("#sample_file").modal("show");

        let data = {"sample_id": e};

        $.ajax(
            {
                url: 'selectSampleFile',
                method: 'POST',
                dataType: 'json',
                data: data,
                success: function (result) {
                    $("#upload_id").val(e);

                    let file_list = $("#file_list");
                    let file_add = "";

                    for (let i = 0; i < result.sample_file.length; i++) {
                        let file = JSON.stringify(result.sample_file[i]);
                        let file_json = file.replace(/\"/g, "&quot;");

                        file_add += '<tr>';
                        file_add += '<td>' + (i + 1) + '</td>';
                        file_add += '<td><button onclick="ModifyBtn(' + result.sample_file[i].sample_file_id + ')" style="border:0px; color:blue; background: white;">' + result.sample_file[i].sample_file_title + '</button></td>';
                        file_add += '<td>' + result.sample_file[i].create_date + '</td>';
                        file_add += '<td><input type="hidden" id="file_' + result.sample_file[i].sample_file_id + '" value="' + file.replace(/\"/g, "&quot;") + '"></td>';
                        file_add += '</tr>';
                    }

                    file_list.empty();
                    file_list.append(file_add);
                }
            });
    }

    function InsertFileBtn() {
        $("#sample_file").modal("hide");
        $("#insert_file").modal("show");
    }

    function InsertFile() {
        let file = $("#upload_file");
        let title = $(".file_title");

        if (file.val() == "") {
            Alert1("파일을 선택해주세요.");
        } else if (title.val() == "") {
            Alert1("제목을 입력하세요.");
        } else {
            $("#insertFile").submit();
        }
    }

    function modifyFile() {
        $("#modifyFile").submit();
    }

    function ModifyBtn(e) {
        let files = JSON.parse($("#file_" + e).val());

        $("#sample_file_id").val(files.sample_file_id);
        $("#sample_file_title").val(files.sample_file_title);
        $("#sample_file_contents").val(files.sample_file_contents);
        $("#uploads_origin_file").text(files.uploads_origin_file);
        $("#uploads_file").val(files.uploads_file);
        $("#file_download").attr("href", "upload/" + files.uploads_file);

        let ele = $("#uploads_file").val(files.uploads_file)[0].defaultValue;

        imgView(ele);

        $("#sample_file").modal("hide");
        $("#modify_file").modal("show");
    }

    /* 첨부파일 */

    // grid
    let samplegrid = null;
    let outcomegrid = null;
    let breedGrid2 = null;
    let outcomeGrid2 = null;
    let updateSampleData = [];
    let updateOutcomeData = [];
    let updateBreedData = [];
    let breedData = [];
    var insertCheck = 0;

    function SearchSample(e) {
        let sample_name = $("#CropSelect").val();
        let limit = $("#limit").val();

        let data = {"sample_name": sample_name, "page_num": e, "limit": limit};

        let loading = document.querySelector('.load_wrap');

        loading.classList.add('on');

        $.ajax(
            {
                url: 'searchSample',
                method: 'POST',
                dataType: 'json',
                data: data,
                success: function (result) {
                    samplegrid = new tui.Grid({
                        el: document.getElementById('sampleGrid'),
                        scrollX: false,
                        scrollY: false,
                        data: result.sample,
                        rowHeaders: ['checkbox'],
                        columns: [
                            {
                                header: '첨부파일',
                                name: 'file',
                                width: 100,
                            },
                            {
                                header: '작물',
                                name: 'sample_name',
                                sortable: true,
                                sortingType: 'asc'
                            },
                            {
                                header: '시교명(ID)',
                                name: 'sample_code',
                                editor: 'text',
                                sortable: true,
                                sortingType: 'asc',
                                filter: {type: 'text', showApplyBtn: true, showClearBtn: true}
                            },
                            {
                                header: '목표 지역',
                                name: 'sample_country',
                                editor: 'text',
                                sortable: true,
                                sortingType: 'asc',
                                filter: {type: 'text', showApplyBtn: true, showClearBtn: true}
                            },
                            {
                                header: '구분',
                                name: 'sample_type',
                                editor: 'text',
                                sortable: true,
                                sortingType: 'asc',
                                filter: {type: 'text', showApplyBtn: true, showClearBtn: true}
                            },
                            {
                                header: '교배번호',
                                name: 'sample_mate',
                                editor: 'text',
                                sortable: true,
                                sortingType: 'asc',
                                filter: {type: 'text', showApplyBtn: true, showClearBtn: true}
                            },
                            {
                                header: '종자번호(ID)',
                                name: 'sample_seed',
                                editor: 'text',
                                sortable: true,
                                sortingType: 'asc',
                                filter: {type: 'text', showApplyBtn: true, showClearBtn: true}
                            },
                            {
                                header: '현 종자량(g)',
                                name: 'sample_amount',
                                editor: 'text',
                                filter: 'number',
                                sortable: true,
                                sortingType: 'asc'
                            },
                            {
                                header: '기내 발아율(%)',
                                name: 'sample_sprout',
                                editor: 'text',
                                filter: 'number',
                                sortable: true,
                                sortingType: 'asc'
                            },
                            {
                                header: '기내 순도율(%)',
                                name: 'sample_purity',
                                editor: 'text',
                                filter: 'number',
                                sortable: true,
                                sortingType: 'asc'
                            },
                            {
                                header: '비고',
                                name: 'sample_comment',
                                editor: 'text',
                                sortable: true,
                                sortingType: 'asc',
                                filter: {type: 'text', showApplyBtn: true, showClearBtn: true}
                            }
                        ],
                        pageOptions: {
                            useClient: true,
                            perPage: limit
                        }
                    });

                    samplegrid.on('click', (ev) => {
                        if (ev.targetType === 'cell' && ev.columnName === 'sample_seed' && insertCheck == 0) {
                            let value_seed = ev.nativeEvent.srcElement;

                            SearchSeed(value_seed);
                        } else if (ev.targetType === 'cell' && ev.columnName === 'sample_code' && insertCheck == 0) {
                            let value_breed = ev.nativeEvent.srcElement;

                            SearchBreed(value_breed);
                        } else if (ev.targetType === 'cell' && ev.columnName === 'file' && insertCheck == 0) {
                            let id = samplegrid.getRow(ev.rowKey).sample_id;

                            FileBtn(id);
                        }
                    });

                    const dataArr = [];

                    for (let i = 0; i < result.sample.length; i++) {
                        let rowArr = {
                            'file': '<i class="bi bi-file-earmark-arrow-down"></i>',
                            'sample_id': result.sample[i].sample_id,
                            'sample_name': result.sample[i].sample_name,
                            'sample_code': result.sample[i].sample_code,
                            'sample_country': result.sample[i].sample_country,
                            'sample_type': result.sample[i].sample_type,
                            'sample_mate': result.sample[i].sample_mate,
                            'sample_seed': result.sample[i].sample_seed,
                            'sample_amount': result.sample[i].sample_amount,
                            'sample_sprout': result.sample[i].sample_sprout,
                            'sample_purity': result.sample[i].sample_purity,
                            'sample_comment': result.sample[i].sample_comment
                        }

                        dataArr.push(rowArr);
                    }

                    samplegrid.resetData(dataArr);

                    let before = null;
                    let after = null;

                    samplegrid.on('dblclick', (ev) => {
                        ev.stop();
                    })

                    samplegrid.on('editingStart', (ev) => {
                        if ($(".plus_btn_submit1")[0].style.display != 'block') {
                            $(".plus_btn_submit2").css("display", "block");
                        }
                    })

                    samplegrid.on('afterChange', (ev) => {
                        let user_type = $("#user_type").val();

                        if (user_type != 0 && user_type != 2) {
                            return Alert("수정 권한이 없습니다.");
                            location.reload();
                        } else {
                            for (let i = 0; i < ev.changes.length; i++) {
                                before = ev.changes[i].prevValue;
                                after = ev.changes[i].value;

                                if (after != before) {
                                    let sample_id = samplegrid.getRow(ev.changes[i].rowKey).sample_id;
                                    let sample_name = ev.changes[i].columnName;
                                    let sample_value = after;

                                    if (sample_id != null) {
                                        updateSampleData.push({"sample_id": sample_id, "sample_name": sample_name, "sample_value": sample_value});
                                    }
                                }

                                if ($(".plus_btn_submit1")[0].style.display != 'block') {
                                    $(".plus_btn_submit2").css("display", "block");
                                }
                            }
                        }
                    });

                    loading.classList.remove('on');
                }
            });

    }

    function SearchOutcome(e) {
        let sample_name1 = $("#CropSelect").val();
        let limit1 = $("#limit").val();

        let data1 = {"sample_name": sample_name1, "page_num": e, "limit": limit1};

        let loading = document.querySelector('.load_wrap');

        loading.classList.add('on');

        $.ajax(
            {
                url: 'searchOutcome',
                method: 'POST',
                dataType: 'json',
                data: data1,
                success: function (result1) {
                    outcomegrid = new tui.Grid({
                        el: document.getElementById('outcomeGrid'),
                        scrollX: false,
                        scrollY: false,
                        data: result1.sampleOutcome,
                        rowHeaders: ['checkbox'],
                        columns: [
                            {
                                header: '시교명',
                                name: 'sample_outcome_code',
                                editor: 'text',
                                sortable: true,
                                filter: {type: 'text', showApplyBtn: true, showClearBtn: true}
                            },
                            {
                                header: '종자번호(ID)',
                                name: 'sample_outcome_num',
                                editor: 'text',
                                sortable: true,
                                filter: {type: 'text', showApplyBtn: true, showClearBtn: true}
                            },
                            {
                                header: '종자 보유량',
                                name: 'sample_outcome_amount',
                                editor: 'text',
                                sortable: true,
                                filter: 'number'
                            },
                            {
                                header: '입고량',
                                name: 'sample_outcome_in',
                                editor: 'text',
                                sortable: true,
                                filter: 'number'
                            },
                            {
                                header: '출고량',
                                name: 'sample_outcome_out',
                                editor: 'text',
                                sortable: true,
                                filter: 'number'
                            },
                            {
                                header: '재고량',
                                name: 'sample_outcome_remain',
                                editor: 'text',
                                sortable: true,
                                filter: 'number'
                            },
                            {
                                header: '담당자',
                                name: 'sample_outcome_person',
                                editor: 'text',
                                sortable: true,
                                filter: {type: 'text', showApplyBtn: true, showClearBtn: true}
                            },
                            {
                                header: '인수자',
                                name: 'sample_outcome_reciever',
                                editor: 'text',
                                sortable: true,
                                filter: {type: 'text', showApplyBtn: true, showClearBtn: true}
                            },
                            {
                                header: '일자',
                                name: 'sample_outcome_date',
                                editor: 'text',
                                filter: 'date',
                                sortable: true
                            },
                            {
                                header: '시교 종료 일자',
                                name: 'sample_outcome_end',
                                editor: 'text',
                                sortable: true,
                                filter: 'date'
                            },
                            {
                                header: '지역 구분',
                                name: 'sample_outcome_country',
                                editor: 'text',
                                sortable: true,
                                filter: {type: 'text', showApplyBtn: true, showClearBtn: true}
                            },
                            {
                                header: '대상 지역',
                                name: 'sample_outcome_place',
                                editor: 'text',
                                sortable: true,
                                filter: {type: 'text', showApplyBtn: true, showClearBtn: true}
                            }
                        ],
                        pageOptions: {
                            useClient: true,
                            perPage: limit1
                        }
                    });

                    const dataArr = [];

                    for (let i = 0; i < result1.sampleOutcome.length; i++) {
                        let rowArr = {
                            'sample_outcome_id': result1.sampleOutcome[i].sample_outcome_id,
                            'sample_outcome_code': result1.sampleOutcome[i].sample_outcome_code,
                            'sample_outcome_num': result1.sampleOutcome[i].sample_outcome_num,
                            'sample_outcome_amount': result1.sampleOutcome[i].sample_outcome_amount,
                            'sample_outcome_in': result1.sampleOutcome[i].sample_outcome_in,
                            'sample_outcome_out': result1.sampleOutcome[i].sample_outcome_out,
                            'sample_outcome_remain': result1.sampleOutcome[i].sample_outcome_remain,
                            'sample_outcome_person': result1.sampleOutcome[i].sample_outcome_person,
                            'sample_outcome_reciever': result1.sampleOutcome[i].sample_outcome_reciever,
                            'sample_outcome_date': result1.sampleOutcome[i].sample_outcome_date,
                            'sample_outcome_end': result1.sampleOutcome[i].sample_outcome_end,
                            'sample_outcome_country': result1.sampleOutcome[i].sample_outcome_country,
                            'sample_outcome_place': result1.sampleOutcome[i].sample_outcome_place
                        }

                        dataArr.push(rowArr);
                    }

                    outcomegrid.resetData(dataArr);

                    outcomegrid.on('dblclick', (ev) => {
                        ev.stop();
                    })

                    outcomegrid.on('click', (ev) => {
                        if (ev.targetType === 'cell' && ev.columnName === 'sample_outcome_num') {
                            let value = ev.nativeEvent.srcElement;

                            SearchSeed(value);
                        }
                    });

                    outcomegrid.on('editingStart', (ev) => {
                        if ($(".plus_btn_submit1")[0].style.display != 'block') {
                            $(".plus_btn_submit2").css("display", "block");
                        }
                    })

                    let before = null;
                    let after = null;

                    outcomegrid.on('afterChange', (ev) => {
                        let user_type = $("#user_type").val();

                        if (user_type != 0 && user_type != 2) {
                            return Alert("수정 권한이 없습니다.");
                            location.reload();
                        } else {
                            for (let i = 0; i < ev.changes.length; i++) {
                                before = ev.changes[i].prevValue;
                                after = ev.changes[i].value;

                                if (after != before) {
                                    let sample_outcome_id = outcomegrid.getRow(ev.changes[i].rowKey).sample_outcome_id
                                    let sample_outcome_name = ev.changes[i].columnName;
                                    let sample_outcome_value = after;

                                    if (sample_outcome_id != null) {
                                        updateOutcomeData.push({
                                            "sample_outcome_id": sample_outcome_id,
                                            "sample_outcome_name": sample_outcome_name,
                                            "sample_outcome_value": sample_outcome_value
                                        });
                                    }
                                }

                                if ($(".plus_btn_submit1")[0].style.display != 'block') {
                                    $(".plus_btn_submit2").css("display", "block");
                                }
                            }
                        }
                    });

                    loading.classList.remove('on');

                }
            });
    }

    function insertRow() {
        let user_type = $("#user_type").val();

        if (user_type != 0 && user_type != 2) {
            return Alert("등록 권한이 없습니다.");
        } else {
            $(".plus_btn_submit1").css("display", "block");

            if (tablechk === 0) {
                if (insertCheck == 0) {
                    let cnt = samplegrid.getRowCount();

                    insertCheck = 1;

                    const newRow = {
                        sample_name: $("#CropSelect").val(),
                    };

                    samplegrid.prependRow(newRow);
                    samplegrid.check(cnt);
                } else {
                    return Alert1("이미 데이터 추가 창이 활성화 중입니다.");
                }

            } else {
                if (insertCheck == 0) {
                    let cnt1 = outcomegrid.getRowCount();

                    insertCheck = 1;

                    const newRow = {
                        sample_name: $("#CropSelect").val(),
                    };

                    outcomegrid.prependRow(newRow);
                    outcomegrid.check(cnt1);
                } else {
                    return Alert1("이미 데이터 추가 창이 활성화 중입니다.");
                }

            }
        }
    }

    function saveRow() {
        if (tablechk === 0) {
            let input_data = [];

            input_data.push(samplegrid.getCheckedRows()[0]);

            $.ajax(
                {
                    url: 'insertSample',
                    method: 'POST',
                    dataType: 'json',
                    data: {
                        "input_data": JSON.stringify(input_data)
                    },
                    success: function (result) {
                        if (result != null) {
                            location.reload();
                        }
                    }
                });
        } else {
            let input_data1 = [];

            input_data1.push(outcomegrid.getCheckedRows()[0]);

            var geoCoder = new google.maps.Geocoder();
            let placement = outcomegrid.getCheckedRows()[0].sample_outcome_place;

            geoCoder.geocode({"address": placement}, function (result, status) {
                if (status == "OK") {
                    input_data1.push(result[0].geometry.location);
                }

                $.ajax(
                    {
                        url: 'insertSampleOutcome',
                        method: 'POST',
                        dataType: 'json',
                        data: {
                            "input_data": JSON.stringify(input_data1)
                        },
                        success: function (result) {
                            if (result == 1) {
                                location.reload();
                            } else {
                                return Alert("데이터 입력에 실패했습니다.");
                            }
                        }
                    })
            });
        }
    }

    function cancelRow() {
        if (tablechk === 0) {
            samplegrid.removeCheckedRows();
        } else {
            outcomegrid.removeCheckedRows();
        }

        $(".plus_btn_submit1").css("display", "none");

        insertCheck = 0;
    }

    function updateRow() {
        if (tablechk == 0) {
            $.ajax(
                {
                    url: 'updateSample',
                    method: 'POST',
                    dataType: 'json',
                    data: {"data": JSON.stringify(updateSampleData)},
                    success: function (result) {
                        if (result == 0) {
                            return Alert("데이터 수정에 실패하였습니다.")
                        } else if (result == 2) {
                            return Alert1("엔터를 눌러 수정을 완료해주세요.")
                        } else {
                            location.reload();
                        }
                    }
                });
        } else {
            $.ajax(
                {
                    url: 'updateOutcome',
                    method: 'POST',
                    dataType: 'json',
                    data: {"data": JSON.stringify(updateOutcomeData)},
                    success: function (result) {
                        if (result == 0) {
                            return Alert("데이터 수정에 실패하였습니다.")
                        } else if (result == 2) {
                            return Alert1("엔터를 눌러 수정을 완료해주세요.")
                        } else {
                            location.reload();
                        }
                    }
                });
        }
    }

    function cancelUpdate() {
        $(".plus_btn_submit2").css("display", "none");

        if ($(".tui-grid-cell-content").hasClass("tui-grid-layer-editing")) {
            $(".tui-grid-cell-content").removeClass("tui-grid-layer-editing");
        }
    }

    function SearchMarker() {
        $.ajax(
            {
                url: 'selectOutcomeList',
                method: 'POST',
                dataType: 'json',
                data: data,
                success: function (result) {
                    var inKorea = [];
                    var outKorea = [];

                    for (let i = 0; i < result.sampleOutcomeKo.length; i++) {
                        inKorea.push(result.sampleOutcomeKo[i]);
                    }

                    for (let i = 0; i < result.sampleOutcomeGlo.length; i++) {
                        outKorea.push(result.sampleOutcomeGlo[i]);
                    }

                    searchArea(inKorea, outKorea);
                }
            });
    }

    /* 지도 검색 */
    $("#modal-search").change(function () {
        searchArea();
    });

    async function searchArea(inKo, outKo) {
        var koreaOptions = {
            zoom: 6.4,
            center: {
                lat: 36.613766432253634,
                lng: 127.84942123102657
            },
            panControl: false,
            zoomControl: false,
            scaleControl: false,
            mapTypeControl: false,
            streetViewControl: false,
            fullscreenControl: false,
            scrollwheel: true,
            // mapTypeId: google.maps.MapTypeId.ROADMAP
        };

        var globalOptions = {
            ...koreaOptions,
            zoom: 2,
        };

        var korMap = new google.maps.Map(document.querySelector("#google_map1"), koreaOptions);
        var globalMap = new google.maps.Map(document.querySelector("#google_map2"), globalOptions);

        var koreaLocations = [];
        var globalLocations = [];

        for (let i = 0; i < inKo.length; i++) {
            koreaLocations.push(inKo[i]);
        }

        for (let o = 0; o < outKo.length; o++) {
            globalLocations.push(outKo[o]);
        }

        for await (const item of koreaLocations) {
            var marker1;

            marker1 = new google.maps.Marker({ // 마커 생성
                map: korMap,
                position: item
            });
        }

        for await (const item of globalLocations) {
            var marker2;

            marker2 = new google.maps.Marker({ // 마커 생성
                map: globalMap,
                position: item
            });
        }
    }

    function smoothZoom(map, max, cnt) {
        if (cnt >= max) {
            return;
        } else {
            z = google.maps.event.addListener(map, 'zoom_changed', function (event) {
                google.maps.event.removeListener(z);
                smoothZoom(map, max, cnt + 1);
            });
            setTimeout(function () {
                map.setZoom(cnt)
            }, 40);
        }
    }

    function makeSelect() {
        let sbox = document.querySelector("#modal-search");

        let info = [];
        let infoTag = [];

        for (let i = 0; i < inKorea.length; i++) {
            info.push(inKorea[i]);
        }

        for (let o = 0; o < outKorea.length; o++) {
            info.push(outKorea[o]);
        }

        for (let i = 0; i < info.length; i++) {
            let optionElement = document.createElement("option");
            optionElement.value = info[i];
            optionElement.innerText = info[i];
            infoTag.push(optionElement);
            sbox.append(infoTag[i]);
        }
    }

    function imgView(e) {
        let fileForm = /(.*?)\.(jpg|jpeg|png|gif|bmp|pdf)$/;

        if (e.match(fileForm)) {
            document.getElementById("preview-image").src = '/upload/' + e;
        }
    }

    // 시교자원출고관리 삭제
    function DeleteSample1() {
        let user_type = $("#user_type").val();

        if (user_type != 0) {
            return Alert("삭제 권한이 없습니다.");
        } else {
            if (tablechk === 3) {
                let total_id1 = [];

                let l1 = outcomeGrid2.getCheckedRows().length;

                for (let i = 0; i < l1; i++) {
                    total_id1.push(outcomeGrid2.getCheckedRows()[i].sample_outcome_id)
                }

                let data1 = {'sample_outcome_id': total_id1};

                if (confirm("삭제하시겠습니까?") == true) {
                    $.ajax(
                        {
                            url: 'deleteOutcome',
                            method: 'POST',
                            dataType: 'json',
                            data: data1,
                            success: function (result) {
                                if (result == 0) {
                                    return Alert("삭제에 실패하였습니다.");
                                } else {
                                    location.reload()
                                }
                            }
                        });
                } else {
                    return false;
                }
            } else if (tablechk === 0) {
                let total_id = [];

                let l = samplegrid.getCheckedRows().length;

                for (let i = 0; i < l; i++) {
                    total_id.push(samplegrid.getCheckedRows()[i].sample_id)
                }

                let data = {'sample_id': total_id};

                if (confirm("삭제하시겠습니까?") == true) {
                    $.ajax(
                        {
                            url: 'deleteSample',
                            method: 'POST',
                            dataType: 'json',
                            data: data,
                            success: function (result) {
                                if (result == 0) {
                                    return Alert("삭제에 실패하였습니다.");
                                } else {
                                    location.reload()
                                }
                            }
                        });
                } else {
                    return false;
                }
            } else {
                let total_id1 = [];

                let l1 = outcomegrid.getCheckedRows().length;

                for (let i = 0; i < l1; i++) {
                    total_id1.push(outcomegrid.getCheckedRows()[i].sample_outcome_id)
                }

                let data1 = {'sample_outcome_id': total_id1};

                if (confirm("삭제하시겠습니까?") == true) {
                    $.ajax(
                        {
                            url: 'deleteOutcome',
                            method: 'POST',
                            dataType: 'json',
                            data: data1,
                            success: function (result) {
                                if (result == 0) {
                                    return Alert("삭제에 실패하였습니다.");
                                } else {
                                    location.reload()
                                }
                            }
                        });
                } else {
                    return false;
                }
            }
        }
    }

    // 품종 삭제
    function DeleteBreed1() {
        let user_type = $("#user_type").val();

        if (user_type != 0) {
            return Alert("삭제 권한이 없습니다.");
        } else {
            if (tablechk === 2) {
                var total_id = [];

                var l = breedGrid2.getCheckedRows().length;

                for (let i = 0; i < l; i++) {
                    total_id.push(breedGrid2.getCheckedRows()[i].breed_id)
                }

                var data = {'breed_id': total_id};

                if (confirm("삭제하시겠습니까?") == true) {
                    $.ajax(
                        {
                            url: 'deleteBreed',
                            method: 'POST',
                            dataType: 'json',
                            data: data,
                            success: function (result) {
                                if (result == 0) {
                                    return Alert("삭제에 실패하였습니다.");
                                } else {
                                    location.reload();
                                }
                            }
                        });
                } else {
                    return false;
                }
            } else if (tablechk === 0) {
                let total_id = [];

                let l = samplegrid.getCheckedRows().length;

                for (let i = 0; i < l; i++) {
                    total_id.push(samplegrid.getCheckedRows()[i].sample_id)
                }

                let data = {'sample_id': total_id};

                if (confirm("삭제하시겠습니까?") == true) {
                    $.ajax(
                        {
                            url: 'deleteSample',
                            method: 'POST',
                            dataType: 'json',
                            data: data,
                            success: function (result) {
                                if (result == 0) {
                                    return Alert("삭제에 실패하였습니다.");
                                } else {
                                    location.reload()
                                }
                            }
                        });
                } else {
                    return false;
                }
            } else {
                let total_id1 = [];

                let l1 = outcomegrid.getCheckedRows().length;

                for (let i = 0; i < l1; i++) {
                    total_id1.push(outcomegrid.getCheckedRows()[i].sample_outcome_id)
                }

                let data1 = {'sample_outcome_id': total_id1};

                if (confirm("삭제하시겠습니까?") == true) {
                    $.ajax(
                        {
                            url: 'deleteOutcome',
                            method: 'POST',
                            dataType: 'json',
                            data: data1,
                            success: function (result) {
                                if (result == 0) {
                                    return Alert("삭제에 실패하였습니다.");
                                } else {
                                    location.reload()
                                }
                            }
                        });
                } else {
                    return false;
                }
            }
        }
    }

    function insertRow1() {
        var user_type = $("#user_type").val();

        if (user_type != 0 && user_type != 2) {
            return Alert("등록 권한이 없습니다.");
        } else {
            $(".plus_btn_submit3").css("display", "block");

            if (tablechk === 2) {
                if (insertCheck == 0) {

                    insertCheck = 1;

                    let cnt = breedGrid2.getRowCount();

                    const newRow = {'breed_id': null, '1': $("#CropSelect").val()};

                    breedGrid2.prependRow(newRow);
                    breedGrid2.check(cnt);

                    breedData.push({'detail_id': 1, 'standard': $("#CropSelect").val()})

                    breedGrid2.on('afterChange', (ev) => {
                        for (let i = 0; i < ev.changes.length; i++) {
                            breedData.push({"detail_id": ev.changes[i].columnName, "standard": ev.changes[i].value})
                        }
                    });
                } else {
                    return Alert1("이미 데이터 추가 창이 활성화 중입니다.");
                }
            } else if (tablechk === 0) {
                if (insertCheck == 0) {
                    let cnt = samplegrid.getRowCount();

                    insertCheck = 1;

                    const newRow = {
                        sample_name: $("#CropSelect").val(),
                    };

                    samplegrid.prependRow(newRow);
                    samplegrid.check(cnt);
                } else {
                    return Alert1("이미 데이터 추가 창이 활성화 중입니다.");
                }

            } else {
                if (insertCheck == 0) {
                    let cnt1 = outcomegrid.getRowCount();

                    insertCheck = 1;

                    const newRow = {
                        sample_name: $("#CropSelect").val(),
                    };

                    outcomegrid.prependRow(newRow);
                    outcomegrid.check(cnt1);
                } else {
                    return Alert1("이미 데이터 추가 창이 활성화 중입니다.");
                }

            }
        }
    }

    function saveRow1() {
        if (tablechk === 2) {
            $.ajax(
                {
                    url: 'insertBreed2',
                    method: 'POST',
                    dataType: 'json',
                    data: {
                        "data": JSON.stringify(breedData)
                    },
                    success: function (result) {
                        if (result != null) {
                            location.reload();
                        }
                    }
                });
        } else if (tablechk === 0) {
            let input_data = [];

            input_data.push(samplegrid.getCheckedRows()[0]);

            $.ajax(
                {
                    url: 'insertSample',
                    method: 'POST',
                    dataType: 'json',
                    data: {
                        "input_data": JSON.stringify(input_data)
                    },
                    success: function (result) {
                        if (result != null) {
                            location.reload();
                        }
                    }
                });
        } else {
            let input_data1 = [];

            input_data1.push(outcomegrid.getCheckedRows()[0]);

            $.ajax(
                {
                    url: 'insertSampleOutcome',
                    method: 'POST',
                    dataType: 'json',
                    data: {
                        "input_data": JSON.stringify(input_data1)
                    },
                    success: function (result) {
                        if (result != null) {
                            location.reload();
                        }
                    }
                });
        }
    }

    function cancelRow1() {
        if (tablechk === 2) {
            breedGrid2.removeCheckedRows();
        } else if (tablechk === 0) {
            samplegrid.removeCheckedRows();
        } else {
            outcomegrid.removeCheckedRows();
        }

        $(".plus_btn_submit3").css("display", "none");

        insertCheck = 0;
    }

    function updateRow1() {
        if (tablechk == 2) {

            $.ajax(
                {
                    url: 'updateBreed',
                    method: 'POST',
                    dataType: 'json',
                    data: {"data": JSON.stringify(updateBreedData)},
                    success: function (result) {
                        if (result == 0) {
                            return Alert("데이터 수정에 실패하였습니다.")
                        } else if (result == 2) {
                            return Alert1("엔터를 눌러 수정을 완료해주세요.")
                        } else {
                            location.reload();
                        }
                    }
                });
        } else if (tablechk == 0) {
            $.ajax(
                {
                    url: 'updateSample',
                    method: 'POST',
                    dataType: 'json',
                    data: {"data": JSON.stringify(updateSampleData)},
                    success: function (result) {
                        if (result == 0) {
                            return Alert("데이터 수정에 실패하였습니다.")
                        } else if (result == 2) {
                            return Alert1("엔터를 눌러 수정을 완료해주세요.")
                        } else {
                            location.reload();
                        }
                    }
                });
        } else {
            $.ajax(
                {
                    url: 'updateOutcome',
                    method: 'POST',
                    dataType: 'json',
                    data: {"data": JSON.stringify(updateOutcomeData)},
                    success: function (result) {
                        if (result == 0) {
                            return Alert("데이터 수정에 실패하였습니다.")
                        } else if (result == 2) {
                            return Alert1("엔터를 눌러 수정을 완료해주세요.")
                        } else {
                            location.reload();
                        }
                    }
                });
        }
    }

    function cancelUpdate1() {
        $(".plus_btn_submit4").css("display", "none");

        if ($(".tui-grid-cell-content").hasClass("tui-grid-layer-editing")) {
            $(".tui-grid-cell-content").removeClass("tui-grid-layer-editing");
        }
    }

    function insertRow2() {
        var user_type = $("#user_type").val();

        if (user_type != 0 && user_type != 2) {
            return Alert("등록 권한이 없습니다.");
        } else {
            $(".plus_btn_submit5").css("display", "block");

            if (tablechk == 3) {
                if (insertCheck == 0) {
                    let cnt1 = outcomeGrid2.getRowCount();

                    insertCheck = 1;

                    const newRow = {
                        sample_name: $("#CropSelect").val(),
                    };

                    outcomeGrid2.prependRow(newRow);
                    outcomeGrid2.check(cnt1);
                } else {
                    return Alert1("이미 데이터 추가 창이 활성화 중입니다.");
                }
            } else if (tablechk === 0) {
                if (insertCheck == 0) {
                    let cnt = samplegrid.getRowCount();

                    insertCheck = 1;

                    const newRow = {
                        sample_name: $("#CropSelect").val(),
                    };

                    samplegrid.prependRow(newRow);
                    samplegrid.check(cnt);
                } else {
                    return Alert1("이미 데이터 추가 창이 활성화 중입니다.");
                }

            } else {
                if (insertCheck == 0) {
                    let cnt1 = outcomegrid.getRowCount();

                    insertCheck = 1;

                    const newRow = {
                        sample_name: $("#CropSelect").val(),
                    };

                    outcomegrid.prependRow(newRow);
                    outcomegrid.check(cnt1);
                } else {
                    return Alert1("이미 데이터 추가 창이 활성화 중입니다.");
                }

            }
        }
    }

    function saveRow2() {
        if (tablechk == 3) {
            var input_data1 = [];

            input_data1.push(outcomeGrid2.getCheckedRows()[0]);

            $.ajax(
                {
                    url: 'insertSampleOutcome',
                    method: 'POST',
                    dataType: 'json',
                    data: {
                        "input_data": JSON.stringify(input_data1)
                    },
                    success: function (result) {
                        if (result != null) {
                            location.reload();
                        }
                    }
                });
        } else if (tablechk === 0) {
            let input_data = [];

            input_data.push(samplegrid.getCheckedRows()[0]);

            $.ajax(
                {
                    url: 'insertSample',
                    method: 'POST',
                    dataType: 'json',
                    data: {
                        "input_data": JSON.stringify(input_data)
                    },
                    success: function (result) {
                        if (result != null) {
                            location.reload();
                        }
                    }
                });
        } else {
            let input_data1 = [];

            input_data1.push(outcomegrid.getCheckedRows()[0]);

            $.ajax(
                {
                    url: 'insertSampleOutcome',
                    method: 'POST',
                    dataType: 'json',
                    data: {
                        "input_data": JSON.stringify(input_data1)
                    },
                    success: function (result) {
                        if (result != null) {
                            location.reload();
                        }
                    }
                });
        }
    }

    function cancelRow2() {
        if (tablechk === 3) {
            outcomeGrid2.removeCheckedRows();
        } else if (tablechk === 2) {
            breedGrid2.removeCheckedRows();
        } else if (tablechk === 0) {
            samplegrid.removeCheckedRows();
        } else {
            outcomegrid.removeCheckedRows();
        }

        $(".plus_btn_submit5").css("display", "none");

        insertCheck = 0;
    }

    function updateRow2() {
        if (tablechk == 3) {
            $.ajax(
                {
                    url: 'updateOutcome',
                    method: 'POST',
                    dataType: 'json',
                    data: {"data": JSON.stringify(updateOutcomeData)},
                    success: function (result) {
                        if (result == 0) {
                            return Alert("데이터 수정에 실패하였습니다.")
                        } else if (result == 2) {
                            return Alert1("엔터를 눌러 수정을 완료해주세요.")
                        } else {
                            location.reload();
                        }
                    }
                });
        } else if (tablechk == 0) {
            $.ajax(
                {
                    url: 'updateSample',
                    method: 'POST',
                    dataType: 'json',
                    data: {"data": JSON.stringify(updateSampleData)},
                    success: function (result) {
                        if (result == 0) {
                            return Alert("데이터 수정에 실패하였습니다.")
                        } else if (result == 2) {
                            return Alert1("엔터를 눌러 수정을 완료해주세요.")
                        } else {
                            location.reload();
                        }
                    }
                });
        } else {
            $.ajax(
                {
                    url: 'updateOutcome',
                    method: 'POST',
                    dataType: 'json',
                    data: {"data": JSON.stringify(updateOutcomeData)},
                    success: function (result) {
                        if (result == 0) {
                            return Alert("데이터 수정에 실패하였습니다.")
                        } else if (result == 2) {
                            return Alert1("엔터를 눌러 수정을 완료해주세요.")
                        } else {
                            location.reload();
                        }
                    }
                });
        }
    }

    function cancelUpdate2() {
        $(".plus_btn_submit6").css("display", "none");

        if ($(".tui-grid-cell-content").hasClass("tui-grid-layer-editing")) {
            $(".tui-grid-cell-content").removeClass("tui-grid-layer-editing");
        }
    }

    function ReportToExcelConverter() {
        $(".TableToExcel").table2excel({
            exclude: ".noExl",
            name: "Excel Document Name",
            filename: "report" + '.xls',
            fileext: ".xls",
            exclude_img: true,
            exclude_links: true,
            exclude_inputs: true
        });
    }
</script>

</body>

</html>