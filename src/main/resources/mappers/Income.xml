<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.thekiban.Mapper.IncomeMapper">

    <!-- 도입자원 목록 조회 -->
    <select id="SelectIncomeList" resultType="Income">
        SELECT *
        FROM income
    </select>

    <!-- 도입자원 등록 -->
    <insert id="InsertIncome" parameterType="Income">
        INSERT INTO income
        (income_id, income_code, income_name, income_kind, income_division, income_place, income_country, income_person, income_date, income_num, income_type, income_trait, income_comment, create_date, modify_date)
        VALUES
        (#{income_id}, #{income_code}, #{income_name}, #{income_kind}, #{income_division}, #{income_place}, #{income_country}, #{income_person}, #{income_date}, #{income_num}, #{income_type}, #{income_trait}, #{income_comment}, NOW(), NOW())
        <selectKey resultType="int" keyProperty="income_id" order="AFTER">
            SELECT LAST_INSERT_ID()
        </selectKey>
    </insert>

    <!-- 도입자원 갯수 조회 -->
    <select id="SelectIncomeCount" parameterType="String" resultType="int">
        SELECT COUNT(*) FROM income
        <choose>
            <when test="income_name != 'none'">
                WHERE income_name = #{income_name}
            </when>
        </choose>
    </select>

    <!-- 도입자원 검색 -->
    <select id="SearchIncome" resultType="Income">
        SELECT * FROM income
        <choose>
            <when test="income_name != 'none'">
                WHERE income_name = #{income_name}
                ORDER BY income_id DESC
            </when>
        </choose>
        LIMIT #{offset}, #{limit}
    </select>

    <!-- 도입자원 삭제 -->
    <select id="DeleteIncome" parameterType="java.util.ArrayList">
        DELETE FROM income
        WHERE
        <foreach collection="array" item="item" open="(" close=")" separator="OR">
            income_id = #{item}
        </foreach>
    </select>

    <!-- 도입자원 수정 -->
    <update id="UpdateIncome" parameterType="Income">
        UPDATE income
        SET income_code     = #{income_code},
            income_name     = #{income_name},
            income_kind     = #{income_kind},
            income_division = #{income_division},
            income_place    = #{income_place},
            income_country  = #{income_country},
            income_person   = #{income_person},
            income_date     = #{income_date},
            income_num      = #{income_num},
            income_type     = #{income_type},
            income_trait    = #{income_trait},
            income_comment  = #{income_comment},
            modify_date     = NOW()
        WHERE income_id = #{income_id}
    </update>

</mapper>
