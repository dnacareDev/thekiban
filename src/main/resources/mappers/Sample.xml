<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.thekiban.Mapper.SampleMapper">

    <!-- 시교자원 목록 조회 -->
    <select id="SelectSampleList" resultType="Sample">
        SELECT *
        FROM sample
    </select>

    <!-- 시교자원 등록 -->
    <insert id="InsertSample" parameterType="Sample">
        INSERT INTO sample
        (sample_id, sample_code, sample_name, sample_country, sample_type,
        sample_mate, sample_seed, sample_amount, sample_sprout, sample_purity,
        sample_comment, create_date, modify_date)
        VALUES (#{sample_id}, #{sample_code}, #{sample_name}, #{sample_country}, #{sample_type},
        #{sample_mate}, #{sample_seed}, #{sample_amount}, #{sample_sprout}, #{sample_purity},
        #{sample_comment}, NOW(), NOW())
        <selectKey resultType="int" keyProperty="sample_id" order="AFTER">
            SELECT LAST_INSERT_ID()
        </selectKey>
    </insert>

    <!-- 시교자원 개수 -->
    <select id="SelectSampleCount" parameterType="String" resultType="int">
        SELECT COUNT(*) FROM sample
        <choose>
            <when test="sample_name != 'none'">
                WHERE sample_name = #{sample_name}
            </when>
        </choose>
    </select>

    <!-- 시교자원 검색 -->
    <select id="SearchSample" resultType="Sample">
        SELECT * FROM sample
        <choose>
            <when test="sample_name != 'none'">
                WHERE sample_name = #{sample_name}
                ORDER BY sample_id DESC
            </when>
        </choose>
        LIMIT #{offset}, #{limit}
    </select>

    <!-- 첨부파일 목록 -->
    <select id="SearchFileList" resultType="SampleFile">
        SELECT * FROM sampleFile
        <choose>
            <when test="sample_id != 'none'">
                WHERE sample_id = #{sample_id}
            </when>
        </choose>
    </select>

    <!-- 시교자원 삭제 -->
    <select id="DeleteSample" parameterType="java.util.ArrayList">
        DELETE FROM sample
        WHERE
        <foreach collection="array" item="item" open="(" close=")" separator="OR">
            sample_id = #{item}
        </foreach>
    </select>

    <!-- 시교자원 수정 -->
    <update id="UpdateSample" parameterType="Sample">
        UPDATE sample
        SET sample_code    = #{sample_code},
            sample_name    = #{sample_name},
            sample_country = #{sample_country},
            sample_type    = #{sample_type},
            sample_mate    = #{sample_mate},
            sample_seed    = #{sample_seed},
            sample_amount  = #{sample_amount},
            sample_sprout  = #{sample_sprout},
            sample_purity  = #{sample_purity},
            sample_comment = #{sample_comment},
            modify_date    = NOW()
        WHERE sample_id = #{sample_id}
    </update>

    <!-- 엑셀파일 등록 -->
    <insert id="InsertExcel" parameterType="Sample">
        INSERT INTO sample
        (sample_id, sample_code, sample_name, sample_country, sample_type,
         sample_mate, sample_seed, sample_amount, sample_sprout, sample_purity,
         sample_comment, create_date, modify_date)
        VALUES (#{sample_id}, #{sample_code}, #{sample_name}, #{sample_country}, #{sample_type},
                #{sample_mate}, #{sample_seed}, #{sample_amount}, #{sample_sprout}, #{sample_purity},
                #{sample_comment}, NOW(), NOW())
    </insert>

    <!-- 수출관리 엑셀 등록 -->
    <insert id="InsertOutcomeExcel" parameterType="SampleOutcome">
        INSERT INTO sample
        (sample_outcome_id, sample_outcome_code, sample_outcome_num, sample_outcome_amount, sample_outcome_in, sample_outcome_out, sample_outcome_remain, sample_outcome_person,
         sample_outcome_reciever, sample_outcome_date, sample_outcome_end, sample_outcome_country, sample_outcome_place)
        VALUES (#{sample_outcome_id}, #{sample_outcome_code}, #{sample_outcome_num}, #{sample_outcome_amount}, #{sample_outcome_in},
                #{sample_outcome_out}, #{sample_outcome_remain}, #{sample_outcome_person}, #{sample_outcome_reciever}, #{sample_outcome_date},
                #{sample_outcome_end}, #{sample_outcome_country}, #{sample_outcome_place})
    </insert>

</mapper>
